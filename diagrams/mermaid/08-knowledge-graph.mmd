%% CORTEX Knowledge Graph Learning
%% Shows Tier 2 pattern learning and decay

graph LR
    subgraph learn["üìö PATTERN LEARNING"]
        L1["Conversation<br/>User: 'add button'"]
        L2["Extract Pattern<br/>Intent: EXECUTE"]
        L3["Store Pattern<br/>Confidence: 0.75"]
    end

    subgraph reuse["üîÑ PATTERN REUSE"]
        R1["Similar Request<br/>'create button'"]
        R2["Search Tier 2<br/>Match: 0.82 similarity"]
        R3["Boost Confidence<br/>0.75 ‚Üí 0.80"]
        R4["Suggest Workflow<br/>button_creation"]
    end

    subgraph decay["‚è≥ PATTERN DECAY"]
        D1["Time Unused<br/>90 days"]
        D2["Decay Rate<br/>5% per 30 days"]
        D3["New Confidence<br/>0.80 ‚Üí 0.65"]
        D4{"Below Threshold?<br/>(< 0.30)"}
        D5["Prune Pattern<br/>Remove from graph"]
        D6["Keep Pattern<br/>Still valuable"]
    end

    subgraph relationships["üîó FILE RELATIONSHIPS"]
        F1["AuthService.cs<br/>modified"]
        F2["LoginController.cs<br/>modified together"]
        F3["Track Co-modification<br/>42 times (75%)"]
        F4["Warn on Change<br/>'Consider updating LoginController'"]
    end

    L1 --> L2
    L2 --> L3
    L3 -.->|"Store in KG"| R2
    
    R1 --> R2
    R2 --> R3
    R3 --> R4
    
    R3 -.->|"After 90 days unused"| D1
    D1 --> D2
    D2 --> D3
    D3 --> D4
    D4 -->|"Yes"| D5
    D4 -->|"No"| D6
    
    F1 --> F2
    F2 --> F3
    F3 --> F4

    style learn fill:#10B981,stroke:#065F46,color:#fff
    style reuse fill:#3B82F6,stroke:#1E3A8A,color:#fff
    style decay fill:#F59E0B,stroke:#92400E,color:#fff
    style relationships fill:#6B46C1,stroke:#4C1D95,color:#fff
