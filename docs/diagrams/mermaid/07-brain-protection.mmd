%% CORTEX Brain Protection System
%% Shows 6 protection layers enforcing Rule #22

graph TD
    USER["üë§ User Proposes Change"]
    
    subgraph detect["üîç CHANGE DETECTION"]
        D1["Scan Intent<br/>Keywords: delete, modify, bypass"]
        D2["Analyze Files<br/>Affected: tier0, brain, governance"]
        D3["Assess Scope<br/>cortex vs application"]
    end

    subgraph protect["üõ°Ô∏è BRAIN PROTECTOR AGENT"]
        BP["Validate Against<br/>6 Protection Layers"]
    end

    subgraph layers["üîê PROTECTION LAYERS"]
        L1["Layer 1:<br/>Instinct Immutability<br/>(Tier 0 rules unchangeable)"]
        L2["Layer 2:<br/>Critical Path Protection<br/>(Core files protected)"]
        L3["Layer 3:<br/>Application Separation<br/>(No app code in CORTEX)"]
        L4["Layer 4:<br/>Brain State Protection<br/>(Memory not committed)"]
        L5["Layer 5:<br/>Namespace Isolation<br/>(Scope boundaries enforced)"]
        L6["Layer 6:<br/>Architectural Integrity<br/>(Design principles maintained)"]
    end

    subgraph response["‚ö° RESPONSE"]
        R1{"Severity?"}
        R2["üö´ BLOCKED<br/>Cannot proceed"]
        R3["‚ö†Ô∏è WARNING<br/>Challenge with alternatives"]
        R4["‚úÖ ALLOWED<br/>Proceed with caution"]
    end

    USER --> D1
    D1 --> D2
    D2 --> D3
    D3 --> BP
    
    BP --> L1
    BP --> L2
    BP --> L3
    BP --> L4
    BP --> L5
    BP --> L6
    
    L1 --> R1
    L2 --> R1
    L3 --> R1
    L4 --> R1
    L5 --> R1
    L6 --> R1
    
    R1 -->|"Critical Violation"| R2
    R1 -->|"Risky Change"| R3
    R1 -->|"Safe Operation"| R4
    
    R2 --> ALT["Suggest Safer<br/>Alternatives"]
    R3 --> ALT
    R4 --> EXEC["Execute with<br/>Monitoring"]

    style detect fill:#3B82F6,stroke:#1E3A8A,color:#fff
    style protect fill:#6B46C1,stroke:#4C1D95,color:#fff
    style layers fill:#EF4444,stroke:#991B1B,color:#fff
    style response fill:#10B981,stroke:#065F46,color:#fff
