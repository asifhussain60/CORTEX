# CORTEX Case Study Metrics Schema
# Version: 1.0
# Purpose: Standardized metric definitions for all case studies

schema_version: "1.0"
last_updated: "2025-11-24"

# ============================================
# APPLICATION METADATA
# ============================================
application:
  required: true
  fields:
    name:
      type: string
      required: true
      description: "Application name"
    type:
      type: string
      required: true
      enum: ["Blazor Server", "React", "Angular", "Vue", "ASP.NET MVC", "Web API", "Desktop", "Mobile"]
      description: "Application technology stack"
    domain:
      type: string
      required: true
      description: "Business domain or industry"
    company:
      type: string
      required: false
      description: "Company name (optional for privacy)"
    year:
      type: integer
      required: true
      description: "Year of engagement"

# ============================================
# ENGAGEMENT METADATA
# ============================================
engagement:
  required: true
  fields:
    title:
      type: string
      required: true
      description: "Engagement title (e.g., 'SignalR Architecture Refactoring')"
    type:
      type: string
      required: true
      enum: ["Refactoring", "Greenfield Development", "Bug Fix", "Performance Optimization", "Migration", "Architecture Design"]
      description: "Type of CORTEX engagement"
    duration_days:
      type: float
      required: true
      description: "Total duration in days"
    phases:
      type: array
      required: true
      description: "List of work phases"
      items:
        id:
          type: integer
          required: true
        name:
          type: string
          required: true
        duration_days:
          type: float
          required: false
        duration_hours:
          type: float
          required: false
        duration_minutes:
          type: integer
          required: false
        description:
          type: string
          required: false
        tests_created:
          type: integer
          required: false
        lines_changed:
          type: integer
          required: false

# ============================================
# CODE METRICS
# ============================================
code_metrics:
  required: true
  fields:
    reduction:
      type: object
      required: true
      fields:
        before_lines:
          type: integer
          required: true
          description: "Total lines before refactoring"
        after_component_lines:
          type: integer
          required: true
          description: "Component lines after refactoring"
        service_lines:
          type: integer
          required: false
          description: "New service layer lines"
        test_lines:
          type: integer
          required: false
          description: "Test lines added"
        net_change:
          type: integer
          required: true
          description: "Net line change (can be negative)"
        duplication_removed:
          type: integer
          required: false
          description: "Duplicate code lines removed"
        percentage_reduction:
          type: float
          required: false
          description: "Percentage reduction in component code"
    
    complexity:
      type: object
      required: false
      fields:
        cyclomatic_before:
          type: float
          required: false
        cyclomatic_after:
          type: float
          required: false
        cognitive_before:
          type: float
          required: false
        cognitive_after:
          type: float
          required: false

# ============================================
# QUALITY METRICS
# ============================================
quality_metrics:
  required: true
  fields:
    test_coverage_before:
      type: float
      required: true
      description: "Test coverage percentage before"
    test_coverage_after:
      type: float
      required: true
      description: "Test coverage percentage after"
    unit_tests_created:
      type: integer
      required: false
      description: "Number of unit tests created"
    integration_tests_created:
      type: integer
      required: false
      description: "Number of integration tests created"
    test_pass_rate:
      type: float
      required: true
      description: "Percentage of tests passing"
    bugs_found:
      type: integer
      required: false
      description: "Bugs discovered during work"
    bugs_fixed:
      type: integer
      required: false
      description: "Bugs fixed during work"

# ============================================
# RELIABILITY METRICS
# ============================================
reliability_metrics:
  required: false
  fields:
    connection_success_before:
      type: float
      required: false
      description: "Connection success rate before (%)"
    connection_success_after:
      type: float
      required: false
      description: "Connection success rate after (%)"
    error_rate_before:
      type: float
      required: false
      description: "Error rate before (%)"
    error_rate_after:
      type: float
      required: false
      description: "Error rate after (%)"
    uptime_before:
      type: float
      required: false
      description: "System uptime before (%)"
    uptime_after:
      type: float
      required: false
      description: "System uptime after (%)"

# ============================================
# PERFORMANCE METRICS
# ============================================
performance_metrics:
  required: false
  fields:
    response_time_before_ms:
      type: integer
      required: false
      description: "Average response time before (ms)"
    response_time_after_ms:
      type: integer
      required: false
      description: "Average response time after (ms)"
    throughput_before:
      type: integer
      required: false
      description: "Requests per second before"
    throughput_after:
      type: integer
      required: false
      description: "Requests per second after"
    memory_usage_before_mb:
      type: integer
      required: false
      description: "Memory usage before (MB)"
    memory_usage_after_mb:
      type: integer
      required: false
      description: "Memory usage after (MB)"

# ============================================
# ARCHITECTURE METRICS
# ============================================
architecture_metrics:
  required: false
  fields:
    services_created:
      type: integer
      required: false
      description: "New service interfaces created"
    components_refactored:
      type: integer
      required: false
      description: "Components refactored"
    event_handlers_centralized:
      type: integer
      required: false
      description: "Event handlers centralized"
    dependencies_removed:
      type: integer
      required: false
      description: "Dependencies eliminated"
    design_patterns_applied:
      type: array
      required: false
      description: "Design patterns introduced"
      items:
        type: string

# ============================================
# BUSINESS IMPACT METRICS
# ============================================
business_impact:
  required: false
  fields:
    time_saved_hours:
      type: float
      required: false
      description: "Developer hours saved annually"
    cost_saved_usd:
      type: integer
      required: false
      description: "Estimated annual cost savings (USD)"
    maintenance_reduction_percent:
      type: float
      required: false
      description: "Reduction in maintenance effort (%)"
    deployment_frequency_improvement:
      type: string
      required: false
      description: "Change in deployment frequency"

# ============================================
# CORTEX EFFICIENCY METRICS
# ============================================
cortex_efficiency:
  required: true
  fields:
    debugging_time_minutes:
      type: integer
      required: false
      description: "Time to identify and fix critical issues"
    tool_usage:
      type: array
      required: false
      description: "GitHub Copilot tools used effectively"
      items:
        type: string
    minimal_intervention:
      type: boolean
      required: false
      description: "Achieved with minimal code changes"
    documentation_lines:
      type: integer
      required: false
      description: "Documentation lines generated"

# ============================================
# VALIDATION RULES
# ============================================
validation:
  rules:
    - name: "Duration consistency"
      check: "Sum of phase durations should equal total duration"
    - name: "Test coverage improvement"
      check: "test_coverage_after >= test_coverage_before"
    - name: "Net change calculation"
      check: "net_change = (after_component_lines + service_lines + test_lines) - before_lines"
    - name: "Percentage calculations"
      check: "All percentage values between 0 and 100"
    - name: "Required metrics presence"
      check: "application, engagement, code_metrics, quality_metrics must be present"

# ============================================
# EXAMPLES & DOCUMENTATION
# ============================================
examples:
  minimal_case_study:
    description: "Minimum required metrics for case study"
    required_fields:
      - application.name
      - application.type
      - application.domain
      - engagement.title
      - engagement.type
      - engagement.duration_days
      - code_metrics.reduction.before_lines
      - code_metrics.reduction.after_component_lines
      - code_metrics.reduction.net_change
      - quality_metrics.test_coverage_before
      - quality_metrics.test_coverage_after
      - quality_metrics.test_pass_rate
      - cortex_efficiency (any fields)
  
  comprehensive_case_study:
    description: "All available metrics populated"
    includes:
      - "All minimal fields"
      - "Performance metrics"
      - "Reliability metrics"
      - "Architecture metrics"
      - "Business impact metrics"
      - "Detailed phase breakdown"

# ============================================
# RENDERING GUIDELINES
# ============================================
rendering:
  guidelines:
    stat_cards:
      description: "Use for key metrics (4-6 cards max)"
      suitable_for: ["code reduction", "test coverage", "connection success", "time saved"]
    
    comparison_tables:
      description: "Use for before/after comparisons"
      suitable_for: ["code metrics", "performance metrics", "reliability metrics"]
    
    timeline_charts:
      description: "Use for phase progression"
      suitable_for: ["engagement phases", "milestone tracking"]
    
    bar_charts:
      description: "Use for metric comparisons"
      suitable_for: ["architecture metrics", "test counts", "duration comparisons"]
