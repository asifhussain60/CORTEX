{
  "patterns": {
    "basicAuth": {
      "keywords": ["username", "password", "basic auth", "session", "cookie"],
      "contextMatch": ["authentication", "auth", "login", "security"],
      "suggestions": [
        {
          "id": "mfa",
          "title": "Multi-Factor Authentication (MFA)",
          "description": "Add an extra layer of security with TOTP, SMS, or biometric verification",
          "effort": { "min": 3, "max": 5, "unit": "days" },
          "impact": {
            "security": "+40%",
            "ux": "+10%",
            "compliance": "SOC 2, PCI-DSS ready"
          },
          "visualExample": "show-mfa-flow",
          "priority": "high",
          "learnMoreUrl": "https://owasp.org/www-community/controls/Multifactor_Authentication"
        },
        {
          "id": "oauth",
          "title": "OAuth 2.0 / OpenID Connect",
          "description": "Industry-standard protocol for secure authorization",
          "effort": { "min": 5, "max": 7, "unit": "days" },
          "impact": {
            "security": "+50%",
            "ux": "+20%",
            "compliance": "Industry standard"
          },
          "visualExample": "show-oauth-diagram",
          "priority": "high",
          "learnMoreUrl": "https://oauth.net/2/"
        },
        {
          "id": "webauthn",
          "title": "Passwordless Authentication (WebAuthn)",
          "description": "Modern biometric and hardware key authentication",
          "effort": { "min": 7, "max": 10, "unit": "days" },
          "impact": {
            "security": "+60%",
            "ux": "+35%",
            "compliance": "FIDO2 certified"
          },
          "visualExample": "show-webauthn-demo",
          "priority": "medium",
          "learnMoreUrl": "https://webauthn.io/"
        }
      ]
    },
    "performanceBottleneck": {
      "keywords": ["slow", "latency", "timeout", ">500ms", ">1000ms", "bottleneck"],
      "contextMatch": ["performance", "speed", "optimization", "api", "database"],
      "suggestions": [
        {
          "id": "caching",
          "title": "Implement Caching Strategy",
          "description": "Add Redis/Memcached for frequently accessed data",
          "effort": { "min": 2, "max": 4, "unit": "days" },
          "impact": {
            "performance": "+60%",
            "cost": "-30% (reduced DB load)",
            "scalability": "10x capacity"
          },
          "visualExample": "show-caching-architecture",
          "priority": "high",
          "learnMoreUrl": "https://aws.amazon.com/caching/"
        },
        {
          "id": "async-processing",
          "title": "Asynchronous Processing",
          "description": "Move long-running tasks to background queues",
          "effort": { "min": 3, "max": 5, "unit": "days" },
          "impact": {
            "performance": "+70% (response time)",
            "ux": "+40% (perceived speed)",
            "reliability": "Better error handling"
          },
          "visualExample": "show-async-flow",
          "priority": "high",
          "learnMoreUrl": "https://microservices.io/patterns/data/event-driven-architecture.html"
        },
        {
          "id": "database-optimization",
          "title": "Database Query Optimization",
          "description": "Add indexes, optimize queries, implement connection pooling",
          "effort": { "min": 1, "max": 2, "unit": "weeks" },
          "impact": {
            "performance": "+45% (query time)",
            "cost": "-20% (resource usage)",
            "scalability": "Better under load"
          },
          "visualExample": "show-query-optimization",
          "priority": "medium",
          "learnMoreUrl": "https://use-the-index-luke.com/"
        }
      ]
    },
    "securityVulnerability": {
      "keywords": ["vulnerability", "security", "exploit", "injection", "xss", "csrf"],
      "contextMatch": ["security", "owasp", "compliance", "audit"],
      "suggestions": [
        {
          "id": "security-headers",
          "title": "Implement Security Headers",
          "description": "Add CSP, HSTS, X-Frame-Options, etc.",
          "effort": { "min": 1, "max": 2, "unit": "days" },
          "impact": {
            "security": "+25%",
            "compliance": "OWASP recommended",
            "effort": "Low implementation cost"
          },
          "visualExample": "show-security-headers",
          "priority": "high",
          "learnMoreUrl": "https://owasp.org/www-project-secure-headers/"
        },
        {
          "id": "dependency-scanning",
          "title": "Automated Dependency Scanning",
          "description": "Continuous monitoring for vulnerable packages",
          "effort": { "min": 2, "max": 3, "unit": "days" },
          "impact": {
            "security": "+30%",
            "automation": "Daily scans",
            "alerts": "Real-time notifications"
          },
          "visualExample": "show-dependency-scanning",
          "priority": "medium",
          "learnMoreUrl": "https://snyk.io/learn/application-security/"
        },
        {
          "id": "penetration-testing",
          "title": "Regular Penetration Testing",
          "description": "Professional security assessments",
          "effort": { "min": 1, "max": 2, "unit": "weeks" },
          "impact": {
            "security": "+40%",
            "compliance": "Required for SOC 2/PCI-DSS",
            "confidence": "Third-party validation"
          },
          "visualExample": "show-pentest-process",
          "priority": "medium",
          "learnMoreUrl": "https://owasp.org/www-community/Penetration_Testing"
        }
      ]
    },
    "complexCode": {
      "keywords": ["complex", "spaghetti", "technical debt", "refactor", "code smell"],
      "contextMatch": ["quality", "maintainability", "refactoring", "code review"],
      "suggestions": [
        {
          "id": "extract-method",
          "title": "Extract Method Refactoring",
          "description": "Break large methods into smaller, testable units",
          "effort": { "min": 3, "max": 5, "unit": "days" },
          "impact": {
            "maintainability": "+35%",
            "testability": "+50%",
            "readability": "Much clearer"
          },
          "visualExample": "show-extract-method",
          "priority": "high",
          "learnMoreUrl": "https://refactoring.guru/extract-method"
        },
        {
          "id": "introduce-patterns",
          "title": "Apply Design Patterns",
          "description": "Use Strategy, Factory, or Repository patterns",
          "effort": { "min": 1, "max": 2, "unit": "weeks" },
          "impact": {
            "maintainability": "+40%",
            "flexibility": "Easier to extend",
            "team": "Common vocabulary"
          },
          "visualExample": "show-design-patterns",
          "priority": "medium",
          "learnMoreUrl": "https://refactoring.guru/design-patterns"
        },
        {
          "id": "automated-refactoring",
          "title": "Use Automated Refactoring Tools",
          "description": "Leverage IDE and static analysis tools",
          "effort": { "min": 1, "max": 3, "unit": "days" },
          "impact": {
            "speed": "+60% (faster refactoring)",
            "safety": "Reduced risk of bugs",
            "consistency": "Automated standards"
          },
          "visualExample": "show-refactoring-tools",
          "priority": "low",
          "learnMoreUrl": "https://www.jetbrains.com/resharper/features/refactorings.html"
        }
      ]
    },
    "lowTestCoverage": {
      "keywords": ["test coverage", "untested", "no tests", "low coverage", "<50%"],
      "contextMatch": ["testing", "quality", "reliability", "ci/cd"],
      "suggestions": [
        {
          "id": "tdd-adoption",
          "title": "Adopt Test-Driven Development (TDD)",
          "description": "RED → GREEN → REFACTOR workflow",
          "effort": { "min": 2, "max": 3, "unit": "weeks" },
          "impact": {
            "quality": "+50%",
            "coverage": "90%+ achievable",
            "confidence": "Safe refactoring"
          },
          "visualExample": "show-tdd-workflow",
          "priority": "high",
          "learnMoreUrl": "https://github.com/asifhussain60/CORTEX"
        },
        {
          "id": "mutation-testing",
          "title": "Implement Mutation Testing",
          "description": "Test the tests - find weak test assertions",
          "effort": { "min": 1, "max": 2, "unit": "weeks" },
          "impact": {
            "quality": "+30%",
            "coverage": "True quality metric",
            "bugs": "Catch more edge cases"
          },
          "visualExample": "show-mutation-testing",
          "priority": "medium",
          "learnMoreUrl": "https://stryker-mutator.io/"
        },
        {
          "id": "integration-tests",
          "title": "Add Integration Test Suite",
          "description": "Test component interactions end-to-end",
          "effort": { "min": 1, "max": 2, "unit": "weeks" },
          "impact": {
            "confidence": "+40%",
            "bugs": "Catch integration issues",
            "deployment": "Safer releases"
          },
          "visualExample": "show-integration-tests",
          "priority": "medium",
          "learnMoreUrl": "https://martinfowler.com/bliki/IntegrationTest.html"
        }
      ]
    }
  },
  "triggerThresholds": {
    "qualityScore": {
      "poor": 50,
      "average": 75,
      "good": 90
    },
    "latency": {
      "good": 200,
      "acceptable": 500,
      "poor": 1000,
      "critical": 2000
    },
    "vulnerabilities": {
      "low": 5,
      "medium": 10,
      "high": 20,
      "critical": 50
    },
    "testCoverage": {
      "poor": 50,
      "acceptable": 70,
      "good": 85,
      "excellent": 95
    }
  }
}
