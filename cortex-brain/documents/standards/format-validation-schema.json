{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://github.com/asifhussain60/CORTEX/schemas/documentation-format-v1.0.json",
  "title": "CORTEX Documentation Format Validation Schema",
  "description": "JSON schema for validating CORTEX admin dashboard documentation outputs",
  "version": "1.0.0",
  "type": "object",
  "required": [
    "metadata",
    "structure",
    "layers",
    "visualizations",
    "security",
    "export"
  ],
  "properties": {
    "metadata": {
      "type": "object",
      "description": "Dashboard metadata and identification",
      "required": ["title", "timestamp", "author", "version", "operation"],
      "properties": {
        "title": {
          "type": "string",
          "description": "Dashboard title",
          "minLength": 5,
          "maxLength": 100,
          "pattern": "^[A-Za-z0-9\\s\\-:]+$"
        },
        "timestamp": {
          "type": "string",
          "description": "ISO 8601 timestamp",
          "format": "date-time"
        },
        "author": {
          "type": "string",
          "description": "Author attribution",
          "const": "Asif Hussain | GitHub: github.com/asifhussain60/CORTEX"
        },
        "version": {
          "type": "string",
          "description": "Format specification version",
          "pattern": "^\\d+\\.\\d+\\.\\d+$"
        },
        "operation": {
          "type": "string",
          "description": "Admin operation that generated this dashboard",
          "enum": [
            "system-alignment",
            "architecture-review",
            "deployment-validation",
            "test-validation",
            "security-audit",
            "performance-analysis",
            "documentation-generation",
            "brain-export",
            "epm-setup"
          ]
        }
      }
    },
    "structure": {
      "type": "object",
      "description": "HTML structure validation",
      "required": ["doctype", "libraries", "csp", "tabs"],
      "properties": {
        "doctype": {
          "type": "string",
          "description": "HTML doctype",
          "const": "<!DOCTYPE html>"
        },
        "libraries": {
          "type": "object",
          "description": "Required external libraries",
          "required": ["d3js", "html2canvas", "jspdf"],
          "properties": {
            "d3js": {
              "type": "object",
              "required": ["version", "url"],
              "properties": {
                "version": {
                  "type": "string",
                  "description": "D3.js version (minimum 7.8.5)",
                  "pattern": "^7\\.(8\\.[5-9]|9\\.\\d+|\\d{2,}\\.\\d+)$"
                },
                "url": {
                  "type": "string",
                  "format": "uri",
                  "pattern": "^https://d3js\\.org/d3\\.v7\\.min\\.js$"
                }
              }
            },
            "html2canvas": {
              "type": "object",
              "required": ["version", "url"],
              "properties": {
                "version": {
                  "type": "string",
                  "pattern": "^1\\.[4-9]\\.\\d+$"
                },
                "url": {
                  "type": "string",
                  "format": "uri",
                  "pattern": "^https://cdnjs\\.cloudflare\\.com/ajax/libs/html2canvas/"
                }
              }
            },
            "jspdf": {
              "type": "object",
              "required": ["version", "url"],
              "properties": {
                "version": {
                  "type": "string",
                  "pattern": "^2\\.[5-9]\\.\\d+$"
                },
                "url": {
                  "type": "string",
                  "format": "uri",
                  "pattern": "^https://cdnjs\\.cloudflare\\.com/ajax/libs/jspdf/"
                }
              }
            }
          }
        },
        "csp": {
          "type": "object",
          "description": "Content Security Policy validation",
          "required": ["present", "directives"],
          "properties": {
            "present": {
              "type": "boolean",
              "const": true
            },
            "directives": {
              "type": "object",
              "required": ["default-src", "script-src", "style-src"],
              "properties": {
                "default-src": {
                  "type": "array",
                  "items": {
                    "type": "string",
                    "enum": ["'self'", "https://d3js.org", "https://cdnjs.cloudflare.com"]
                  },
                  "minItems": 1
                },
                "script-src": {
                  "type": "array",
                  "items": {
                    "type": "string",
                    "enum": ["'self'", "'unsafe-inline'", "https://d3js.org", "https://cdnjs.cloudflare.com"]
                  },
                  "minItems": 2
                },
                "style-src": {
                  "type": "array",
                  "items": {
                    "type": "string",
                    "enum": ["'self'", "'unsafe-inline'"]
                  },
                  "minItems": 2
                }
              }
            }
          }
        },
        "tabs": {
          "type": "object",
          "description": "Tab navigation structure",
          "required": ["count", "navigation", "content"],
          "properties": {
            "count": {
              "type": "integer",
              "description": "Number of tabs (minimum 5)",
              "minimum": 5
            },
            "navigation": {
              "type": "object",
              "required": ["present", "functional"],
              "properties": {
                "present": {
                  "type": "boolean",
                  "const": true
                },
                "functional": {
                  "type": "boolean",
                  "const": true
                }
              }
            },
            "content": {
              "type": "object",
              "required": ["activeClass", "transitionEffect"],
              "properties": {
                "activeClass": {
                  "type": "string",
                  "const": "active"
                },
                "transitionEffect": {
                  "type": "boolean",
                  "const": true
                }
              }
            }
          }
        }
      }
    },
    "layers": {
      "type": "array",
      "description": "Dashboard layers (minimum 5)",
      "minItems": 5,
      "items": {
        "type": "object",
        "required": ["id", "name", "order", "elements"],
        "properties": {
          "id": {
            "type": "string",
            "description": "Layer DOM ID",
            "pattern": "^layer-[a-z-]+$"
          },
          "name": {
            "type": "string",
            "description": "Layer display name",
            "enum": [
              "Executive Summary",
              "Detailed Analysis",
              "Issues & Recommendations",
              "Technical Details",
              "Export & Actions"
            ]
          },
          "order": {
            "type": "integer",
            "description": "Tab order (1-5)",
            "minimum": 1,
            "maximum": 10
          },
          "elements": {
            "type": "object",
            "description": "Required elements per layer",
            "required": ["heading", "content"],
            "properties": {
              "heading": {
                "type": "object",
                "required": ["present", "level"],
                "properties": {
                  "present": {
                    "type": "boolean",
                    "const": true
                  },
                  "level": {
                    "type": "string",
                    "enum": ["h1", "h2", "h3"]
                  }
                }
              },
              "content": {
                "type": "object",
                "required": ["present", "minWordCount"],
                "properties": {
                  "present": {
                    "type": "boolean",
                    "const": true
                  },
                  "minWordCount": {
                    "type": "integer",
                    "minimum": 50
                  }
                }
              },
              "visualization": {
                "type": "object",
                "description": "D3.js visualization (if required)",
                "properties": {
                  "present": {
                    "type": "boolean"
                  },
                  "type": {
                    "type": "string",
                    "enum": [
                      "gauge",
                      "radial",
                      "tree",
                      "force-graph",
                      "matrix",
                      "heatmap",
                      "timeline",
                      "thumbnail"
                    ]
                  }
                }
              }
            }
          }
        }
      }
    },
    "visualizations": {
      "type": "object",
      "description": "D3.js visualization validation",
      "required": ["count", "types", "interactivity", "accessibility"],
      "properties": {
        "count": {
          "type": "integer",
          "description": "Number of D3.js visualizations (minimum 5, one per layer)",
          "minimum": 5
        },
        "types": {
          "type": "array",
          "description": "Visualization types used",
          "items": {
            "type": "string",
            "enum": [
              "gauge",
              "radial",
              "tree",
              "force-graph",
              "matrix",
              "heatmap",
              "timeline",
              "thumbnail",
              "bar-chart",
              "line-chart",
              "scatter-plot"
            ]
          },
          "minItems": 5
        },
        "interactivity": {
          "type": "object",
          "description": "Interactive features",
          "required": ["hover", "click", "zoom"],
          "properties": {
            "hover": {
              "type": "boolean",
              "description": "Hover tooltips present",
              "const": true
            },
            "click": {
              "type": "boolean",
              "description": "Click interactions present",
              "const": true
            },
            "zoom": {
              "type": "boolean",
              "description": "Zoom/pan functionality (for complex visualizations)"
            }
          }
        },
        "accessibility": {
          "type": "object",
          "description": "Accessibility features",
          "required": ["ariaLabels", "titles", "descriptions"],
          "properties": {
            "ariaLabels": {
              "type": "boolean",
              "description": "ARIA labels present on all SVG elements",
              "const": true
            },
            "titles": {
              "type": "boolean",
              "description": "<title> tags in SVG elements",
              "const": true
            },
            "descriptions": {
              "type": "boolean",
              "description": "<desc> tags in SVG elements",
              "const": true
            }
          }
        },
        "sanitization": {
          "type": "object",
          "description": "Data sanitization for XSS prevention",
          "required": ["implemented", "method"],
          "properties": {
            "implemented": {
              "type": "boolean",
              "const": true
            },
            "method": {
              "type": "string",
              "enum": ["textContent", "DOMPurify", "custom-sanitizer"]
            }
          }
        }
      }
    },
    "security": {
      "type": "object",
      "description": "Security validation",
      "required": ["csp", "xss", "dataValidation", "inlineHandlers"],
      "properties": {
        "csp": {
          "type": "object",
          "description": "Content Security Policy compliance",
          "required": ["present", "compliant"],
          "properties": {
            "present": {
              "type": "boolean",
              "const": true
            },
            "compliant": {
              "type": "boolean",
              "const": true
            }
          }
        },
        "xss": {
          "type": "object",
          "description": "XSS prevention measures",
          "required": ["inputSanitization", "outputEncoding"],
          "properties": {
            "inputSanitization": {
              "type": "boolean",
              "description": "User input sanitized before rendering",
              "const": true
            },
            "outputEncoding": {
              "type": "boolean",
              "description": "Data encoded for safe HTML output",
              "const": true
            }
          }
        },
        "dataValidation": {
          "type": "object",
          "description": "Data validation before rendering",
          "required": ["schemaValidation", "typeChecking"],
          "properties": {
            "schemaValidation": {
              "type": "boolean",
              "description": "JSON schema validation implemented",
              "const": true
            },
            "typeChecking": {
              "type": "boolean",
              "description": "Runtime type checking for dashboard data",
              "const": true
            }
          }
        },
        "inlineHandlers": {
          "type": "object",
          "description": "Inline event handler check",
          "required": ["present", "count"],
          "properties": {
            "present": {
              "type": "boolean",
              "description": "Inline handlers NOT allowed",
              "const": false
            },
            "count": {
              "type": "integer",
              "description": "Number of inline handlers (must be 0)",
              "const": 0
            }
          }
        }
      }
    },
    "export": {
      "type": "object",
      "description": "Export functionality validation",
      "required": ["formats", "functionality", "performance"],
      "properties": {
        "formats": {
          "type": "object",
          "description": "Supported export formats",
          "required": ["pdf", "png", "pptx"],
          "properties": {
            "pdf": {
              "type": "object",
              "required": ["available", "functional", "includesAllLayers"],
              "properties": {
                "available": {
                  "type": "boolean",
                  "const": true
                },
                "functional": {
                  "type": "boolean",
                  "const": true
                },
                "includesAllLayers": {
                  "type": "boolean",
                  "const": true
                }
              }
            },
            "png": {
              "type": "object",
              "required": ["available", "functional", "highResolution"],
              "properties": {
                "available": {
                  "type": "boolean",
                  "const": true
                },
                "functional": {
                  "type": "boolean",
                  "const": true
                },
                "highResolution": {
                  "type": "boolean",
                  "description": "2x scale for high DPI displays",
                  "const": true
                }
              }
            },
            "pptx": {
              "type": "object",
              "required": ["available", "functional", "preservesFormatting"],
              "properties": {
                "available": {
                  "type": "boolean",
                  "const": true
                },
                "functional": {
                  "type": "boolean",
                  "const": true
                },
                "preservesFormatting": {
                  "type": "boolean",
                  "const": true
                }
              }
            }
          }
        },
        "functionality": {
          "type": "object",
          "description": "Export button functionality",
          "required": ["buttons", "errorHandling", "filenameFormat"],
          "properties": {
            "buttons": {
              "type": "object",
              "required": ["count", "labeled", "accessible"],
              "properties": {
                "count": {
                  "type": "integer",
                  "minimum": 3
                },
                "labeled": {
                  "type": "boolean",
                  "const": true
                },
                "accessible": {
                  "type": "boolean",
                  "const": true
                }
              }
            },
            "errorHandling": {
              "type": "boolean",
              "description": "Graceful error handling for failed exports",
              "const": true
            },
            "filenameFormat": {
              "type": "string",
              "description": "Filename pattern with timestamp",
              "pattern": "^cortex-[a-z-]+-\\d+\\.(pdf|png|pptx)$"
            }
          }
        },
        "performance": {
          "type": "object",
          "description": "Export performance metrics",
          "required": ["maxDuration", "fileSizeLimit"],
          "properties": {
            "maxDuration": {
              "type": "integer",
              "description": "Maximum export duration in seconds",
              "maximum": 5
            },
            "fileSizeLimit": {
              "type": "integer",
              "description": "Maximum file size in MB",
              "maximum": 10
            }
          }
        }
      }
    },
    "performance": {
      "type": "object",
      "description": "Performance requirements",
      "required": ["pageLoad", "rendering", "transitions", "fileSize"],
      "properties": {
        "pageLoad": {
          "type": "object",
          "required": ["duration", "acceptable"],
          "properties": {
            "duration": {
              "type": "number",
              "description": "Page load time in seconds",
              "maximum": 2.0
            },
            "acceptable": {
              "type": "boolean",
              "const": true
            }
          }
        },
        "rendering": {
          "type": "object",
          "required": ["d3Duration", "acceptable"],
          "properties": {
            "d3Duration": {
              "type": "number",
              "description": "D3.js render time per chart in milliseconds",
              "maximum": 500
            },
            "acceptable": {
              "type": "boolean",
              "const": true
            }
          }
        },
        "transitions": {
          "type": "object",
          "required": ["fps", "smooth"],
          "properties": {
            "fps": {
              "type": "integer",
              "description": "Frames per second for transitions",
              "minimum": 60
            },
            "smooth": {
              "type": "boolean",
              "const": true
            }
          }
        },
        "fileSize": {
          "type": "object",
          "required": ["size", "acceptable"],
          "properties": {
            "size": {
              "type": "number",
              "description": "Total file size in MB",
              "maximum": 2.0
            },
            "acceptable": {
              "type": "boolean",
              "const": true
            }
          }
        }
      }
    },
    "annotations": {
      "type": "object",
      "description": "Smart annotation system",
      "required": ["present", "count", "schema"],
      "properties": {
        "present": {
          "type": "boolean",
          "description": "Annotations system implemented"
        },
        "count": {
          "type": "integer",
          "description": "Number of annotations (minimum 5)",
          "minimum": 5
        },
        "schema": {
          "type": "object",
          "description": "Annotation schema compliance",
          "required": ["valid", "types"],
          "properties": {
            "valid": {
              "type": "boolean",
              "const": true
            },
            "types": {
              "type": "array",
              "items": {
                "type": "string",
                "enum": ["tooltip", "popover", "callout", "badge"]
              },
              "minItems": 1
            }
          }
        }
      }
    },
    "styling": {
      "type": "object",
      "description": "Styling requirements",
      "required": ["colorPalette", "typography", "layout"],
      "properties": {
        "colorPalette": {
          "type": "object",
          "description": "CORTEX color palette compliance",
          "required": ["primary", "secondary", "accent", "status"],
          "properties": {
            "primary": {
              "type": "string",
              "const": "#2c3e50"
            },
            "secondary": {
              "type": "string",
              "const": "#3498db"
            },
            "accent": {
              "type": "string",
              "const": "#e74c3c"
            },
            "status": {
              "type": "object",
              "required": ["success", "warning", "error"],
              "properties": {
                "success": {
                  "type": "string",
                  "const": "#27ae60"
                },
                "warning": {
                  "type": "string",
                  "const": "#f39c12"
                },
                "error": {
                  "type": "string",
                  "const": "#e74c3c"
                }
              }
            }
          }
        },
        "typography": {
          "type": "object",
          "description": "Typography standards",
          "required": ["fontFamily", "baseFontSize", "lineHeight"],
          "properties": {
            "fontFamily": {
              "type": "string",
              "pattern": "(apple-system|BlinkMacSystemFont|Segoe UI|Roboto|sans-serif)"
            },
            "baseFontSize": {
              "type": "string",
              "const": "16px"
            },
            "lineHeight": {
              "type": "number",
              "const": 1.6
            }
          }
        },
        "layout": {
          "type": "object",
          "description": "Layout structure",
          "required": ["responsive", "tabNavigation", "contentPadding"],
          "properties": {
            "responsive": {
              "type": "boolean",
              "const": true
            },
            "tabNavigation": {
              "type": "boolean",
              "const": true
            },
            "contentPadding": {
              "type": "boolean",
              "const": true
            }
          }
        }
      }
    },
    "accessibility": {
      "type": "object",
      "description": "Accessibility requirements (WCAG AA)",
      "required": ["aria", "keyboard", "screenReader", "colorContrast"],
      "properties": {
        "aria": {
          "type": "object",
          "required": ["labels", "roles", "descriptions"],
          "properties": {
            "labels": {
              "type": "boolean",
              "const": true
            },
            "roles": {
              "type": "boolean",
              "const": true
            },
            "descriptions": {
              "type": "boolean",
              "const": true
            }
          }
        },
        "keyboard": {
          "type": "object",
          "required": ["navigation", "focusIndicators"],
          "properties": {
            "navigation": {
              "type": "boolean",
              "const": true
            },
            "focusIndicators": {
              "type": "boolean",
              "const": true
            }
          }
        },
        "screenReader": {
          "type": "object",
          "required": ["compatible", "altText"],
          "properties": {
            "compatible": {
              "type": "boolean",
              "const": true
            },
            "altText": {
              "type": "boolean",
              "description": "Alt text on all images and visualizations",
              "const": true
            }
          }
        },
        "colorContrast": {
          "type": "object",
          "required": ["wcagAA", "ratio"],
          "properties": {
            "wcagAA": {
              "type": "boolean",
              "const": true
            },
            "ratio": {
              "type": "number",
              "description": "Minimum contrast ratio",
              "minimum": 4.5
            }
          }
        }
      }
    }
  }
}
