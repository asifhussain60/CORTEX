# Brain Crawler Configuration
# Version: 1.0
# Purpose: Codebase analysis targets and patterns for BRAIN population

crawler_config:
  name: "BRAIN Crawler"
  version: "1.0"
  purpose: "Comprehensive codebase analysis and BRAIN population (Google-style crawler)"
  
crawl_targets:
  
  file_structure:
    components:
      patterns: ["Components/**/*.{razor,tsx,vue,jsx}", "src/components/**/*"]
      feeds: "file_relationships.architectural_patterns.components"
    
    services:
      patterns: ["Services/**/*Service.{cs,ts,js}", "src/services/**/*"]
      feeds: "file_relationships.architectural_patterns.services"
    
    controllers:
      patterns: ["Controllers/**/*Controller.{cs,ts}", "src/controllers/**/*"]
      feeds: "file_relationships.architectural_patterns.controllers"
    
    tests:
      patterns: ["Tests/**/*", "tests/**/*", "**/*.test.{ts,js,cs}", "**/*.spec.{ts,js,cs}"]
      feeds: "file_relationships.architectural_patterns.tests"
    
    config:
      patterns: ["*.json", "*.config.{js,ts}", "appsettings*.json", ".env*"]
      feeds: "file_relationships.configuration"
    
    assets:
      patterns: ["wwwroot/**/*", "public/**/*", "assets/**/*", "**/*.{css,scss,sass}"]
      feeds: "file_relationships.static_assets"
  
  code_relationships:
    dependencies:
      discover:
        - "import/require statements"
        - "using/include directives"
        - "DI registrations"
      feeds: "file_relationships.<filename>.imports"
    
    co_modification:
      source: "git log analysis"
      threshold: 0.6
      feeds: "file_relationships.<filename>.co_modified_with"
    
    composition:
      discover:
        - "parent-child component relationships"
        - "service injection patterns"
        - "API-to-UI mappings"
      feeds: "file_relationships.<filename>.child_components"
  
  test_patterns:
    frameworks:
      detect: ["playwright", "xunit", "jest", "cypress", "puppeteer"]
      feeds: "validation_insights.test_patterns.<framework>"
    
    test_data:
      patterns: ["**/fixtures/**", "**/mocks/**", "**/test-data/**", "session-*"]
      feeds: "validation_insights.test_patterns.<framework>.test_data"
    
    selectors:
      patterns: ["data-testid", "data-test", "test-id", "aria-label"]
      feeds: "validation_insights.test_patterns.<framework>.selector_pattern"
    
    visual_regression:
      detect: ["percy", "chromatic", "applitools", "backstop"]
      feeds: "validation_insights.test_patterns.<framework>.visual_regression"

crawler_behavior:
  
  discovery_phases:
    phase_1_structure:
      duration: "fast"
      operations: ["file scan", "directory tree", "extension mapping"]
      output: "architectural_patterns"
    
    phase_2_relationships:
      duration: "medium"
      operations: ["import analysis", "git history", "DI scanning"]
      output: "file_relationships"
    
    phase_3_deep_analysis:
      duration: "slow"
      operations: ["code parsing", "API mapping", "test coverage"]
      output: "validation_insights + knowledge_graph"
  
  update_strategy:
    incremental:
      trigger: "file modification detected"
      scope: "modified file + dependencies"
      speed: "fast"
    
    full_recrawl:
      trigger: "manual request or 7 days elapsed"
      scope: "entire codebase"
      speed: "slow (run overnight)"
  
  brain_feeding:
    tier_1:
      target: "working_memory.recent_file_activity"
      frequency: "real-time"
    
    tier_2:
      target: "knowledge_graph.file_relationships"
      frequency: "after each crawl phase"
    
    tier_3:
      target: "context_intelligence.architectural_insights"
      frequency: "after full recrawl"

exclusions:
  directories:
    - "node_modules"
    - "bin"
    - "obj"
    - ".git"
    - "dist"
    - "build"
    - "__pycache__"
    - ".venv"
    - "venv"
  
  files:
    - "*.min.js"
    - "*.map"
    - "*.lock"
    - "package-lock.json"
    - "yarn.lock"

output_format:
  file_relationships: "cortex-brain/file-relationships.yaml"
  validation_insights: "cortex-brain/tier3/validation-insights.yaml"
  knowledge_graph: "cortex-brain/knowledge-graph.yaml"
  metrics: "cortex-brain/tier3/crawler-metrics.json"
