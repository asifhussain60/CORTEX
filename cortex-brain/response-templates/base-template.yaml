# CORTEX Response Template System v2.0
# Markdown-Optimized Base Template
# 
# This base template leverages GitHub Copilot Chat's markdown rendering for
# rich, hierarchical, and visually appealing responses.
#
# Author: Asif Hussain | Â© 2024-2025
# Created: 2025-11-20
# Version: 2.0.0

schema_version: "2.0.0"
created: "2025-11-20"
last_updated: "2025-11-20"

# ============================================================================
# DESIGN PRINCIPLES
# ============================================================================

design_principles:
  markdown_first:
    description: "All templates designed for markdown rendering in VS Code Copilot Chat"
    guidelines:
      - "Use proper heading hierarchy (# ## ###)"
      - "Leverage tables for structured data"
      - "Use collapsible sections for complex information"
      - "Bold/italic for emphasis, not just formatting"
      - "Code blocks for file paths, commands, and code"
      
  adaptive_intelligence:
    description: "Responses adapt format based on context, not one-size-fits-all"
    principles:
      - "Simple queries get concise answers (2-3 sentences)"
      - "Complex work gets summary + collapsible details"
      - "Data-heavy content uses tables and visual indicators"
      - "Code shown only when needed (pseudocode > snippet > full code)"
      - "Challenge section appears only when there's something to challenge"
    
    adaptation_triggers:
      request_complexity:
        simple: "Status check, help query, what is question"
        moderate: "Single-phase implementation, bug fix, update"
        complex: "Multi-phase feature, architecture design, planning"
      
      content_type:
        informational: "Explaining concepts, answering questions"
        actionable: "Implementation, changes made, next steps"
        analytical: "Status reports, test results, metrics"
        planning: "Feature planning, design decisions, roadmaps"
      
      information_density:
        low: "1-2 key points, minimal supporting data"
        medium: "3-5 key points with some supporting details"
        high: "6+ key points, tables, metrics, complex relationships"
    
    response_matrix:
      simple_informational: "concise (2-3 sentences)"
      simple_actionable: "concise + bullet list"
      moderate_informational: "summarized (summary + collapsible)"
      moderate_actionable: "detailed (subsections)"
      complex_analytical: "visual (tables, progress bars)"
      complex_planning: "detailed + visual (phases, milestones, gates)"
      
  visual_hierarchy:
    description: "Clear information architecture from high-level to detail"
    levels:
      1: "# Title - Operation type and context"
      2: "## Major sections - Understanding, Challenge, Response, etc."
      3: "### Subsections - Details within responses"
      4: "#### Micro-details - Nested information"
      
  progressive_disclosure:
    description: "Use collapsible sections to manage complexity"
    patterns:
      - "Lead with summary (always visible)"
      - "Hide implementation details in <details> tags"
      - "Collapse phase breakdowns by default"
      - "Expand critical information inline"
      - "Add 'Ask about X for details' prompts"
      - "Trust user to request more information if needed"
      
  scanability:
    description: "Users should grasp key information in 3 seconds"
    techniques:
      - "Emojis for visual anchors"
      - "Bold text for key terms"
      - "Tables for comparisons"
      - "Status indicators (âœ… âš ï¸ âŒ)"
      - "Progress bars (â–“â–“â–“â–‘â–‘â–‘â–‘â–‘â–‘) for percentages"
      - "Horizontal rules for section breaks (use sparingly)"
    
  information_efficiency:
    description: "Don't bury critical information in verbosity"
    rules:
      - "Most important information first (above the fold)"
      - "Supporting details in collapsible sections"
      - "Data in tables (faster to scan than paragraphs)"
      - "Visual indicators (emojis, bars) for quick status"
      - "Invite follow-up questions rather than info-dumping"
    examples:
      wrong: |
        ## Response
        I analyzed the codebase thoroughly by first examining the project structure,
        then reviewing each file individually, checking imports, validating syntax,
        running static analysis tools, and finally generating a comprehensive report.
        The analysis involved 143 files across 12 modules. I checked for common issues
        like circular dependencies, unused imports, and code smells. [... 5 more paragraphs]
      
      right: |
        ## Response
        Analyzed 143 files across 12 modules.
        
        | Issue Type | Count | Severity |
        |------------|-------|----------|
        | Circular Dependencies | 3 | ğŸ”´ High |
        | Unused Imports | 47 | ğŸŸ¡ Medium |
        | Code Smells | 12 | ğŸŸ¢ Low |
        
        <details>
        <summary>ğŸ“‹ <strong>Detailed Analysis</strong></summary>
        
        [Full analysis with file-by-file breakdown]
        </details>
        
        *Ask about any specific issue category for remediation guidance.*

# ============================================================================
# BASE TEMPLATE STRUCTURE
# ============================================================================

base_template:
  name: "Markdown-Optimized Base Template"
  version: "2.0.0"
  description: "Foundation template for all CORTEX responses with markdown-first design"
  
  # Header section - Always visible, consistent branding
  header:
    format: |
      # {emoji} CORTEX {operation_type}
      **Author:** Asif Hussain | Â© 2024-2025 | github.com/asifhussain60/CORTEX
    
    guidelines:
      - "Use single # for top-level heading"
      - "Emoji provides visual context (ğŸ§  for most operations)"
      - "Operation type is clear and descriptive"
      - "Author line uses bold for consistency"
    
    placeholders:
      emoji: "ğŸ§ "
      operation_type: "Operation Type"
    
    example: |
      # ğŸ§  CORTEX Feature Implementation
      **Author:** Asif Hussain | Â© 2024-2025 | github.com/asifhussain60/CORTEX
  
  # Understanding section - What we think user wants
  understanding:
    format: |
      ## ğŸ¯ My Understanding Of Your Request
      {user_intent_summary}
    
    guidelines:
      - "Use ## for major section headings"
      - "Keep summary concise (1-2 sentences max)"
      - "State what they want to ACHIEVE, not what they said"
      - "No indentation needed with markdown headings"
    
    placeholders:
      user_intent_summary: "Description of what user wants to achieve"
    
    max_length: 150
    
    example: |
      ## ğŸ¯ My Understanding Of Your Request
      You want to implement user authentication with JWT tokens and session management
  
  # Challenge section - Intelligent validation (context-aware)
  challenge:
    description: "Smart challenge system - shows only when needed"
    
    decision_logic:
      accept_only:
        condition: "No concerns, request is sound"
        format: |
          ## âœ“ Proceeding
          {brief_rationale}
        guidelines:
          - "One sentence max - why this is sound"
          - "Only show if assumptions validated"
          - "Skip entirely for simple queries with no risk"
        example: |
          ## âœ“ Proceeding
          Standard authentication approach, all dependencies validated.
      
      challenge_only:
        condition: "Significant concerns exist"
        format: |
          ## âš¡ Recommendation
          {concern}
          
          ### ğŸ’¡ Better Approach
          {recommended_alternative}
        guidelines:
          - "State concern clearly and concisely"
          - "Offer ONE best alternative (not list)"
          - "Explain why it's better"
        example: |
          ## âš¡ Recommendation
          Single-table design won't scale beyond 10K users.
          
          ### ğŸ’¡ Better Approach
          **Partition by date** - Split user data by registration date for 100x performance at scale.
      
      mixed:
        condition: "Accept core request, challenge specific aspects"
        format: |
          ## âœ“ Proceeding with Adjustment
          {what_we_accept}
          
          **Recommended Change:** {what_to_adjust}
        guidelines:
          - "State what's good first"
          - "Suggest ONE specific improvement"
          - "Keep total under 3 sentences"
        example: |
          ## âœ“ Proceeding with Adjustment
          Authentication approach is sound.
          
          **Recommended Change:** Use bcrypt instead of SHA-256 for password hashing (industry standard).
      
      none:
        condition: "Simple query, no validation needed"
        format: null
        guidelines:
          - "Skip section entirely for: status checks, simple queries, documentation requests"
          - "No assumptions to validate = no challenge section"
        example: "# (Section omitted - no validation needed)"
    
    intelligent_routing:
      rules:
        - "IF simple query (status, help, what is) â†’ none"
        - "IF request validated with no concerns â†’ accept_only"
        - "IF major concerns with better approach â†’ challenge_only"
        - "IF mostly good but needs tweak â†’ mixed"
        - "DEFAULT â†’ accept_only (trust user unless red flags)"
  
  # Response section - Adaptive verbosity and format
  response:
    description: "Intelligent response adaptation based on request type and complexity"
    
    adaptation_rules:
      
      concise:
        condition: "Simple query, status check, quick answer"
        format: |
          ## ğŸ’¬ Response
          {one_paragraph_answer}
        guidelines:
          - "2-3 sentences max"
          - "Direct answer, no elaboration"
          - "Add 'Ask if you want details on [aspect]' at end"
        example: |
          ## ğŸ’¬ Response
          Documentation generated successfully. Created 43 files in `docs/` (API reference, guides, architecture diagrams). All cross-references validated.
          
          *Ask if you want details on any specific section.*
      
      summarized:
        condition: "Multi-part work completed, user wants overview"
        format: |
          ## ğŸ’¬ Response
          {executive_summary}
          
          <details>
          <summary>ğŸ“Š <strong>Detailed Breakdown</strong></summary>
          
          {detailed_information}
          </details>
        guidelines:
          - "Lead with 3-sentence summary"
          - "Hide details in collapsible section"
          - "Use tables for data-heavy content"
        example: |
          ## ğŸ’¬ Response
          Implemented authentication with JWT tokens, session management, and password hashing. All tests passing (47/47), coverage at 94%. Ready for staging deployment.
          
          <details>
          <summary>ğŸ“Š <strong>Implementation Details</strong></summary>
          
          | Component | Status | Coverage |
          |-----------|--------|----------|
          | JWT Service | âœ… Complete | 96% |
          | Session Manager | âœ… Complete | 92% |
          | Password Hash | âœ… Complete | 98% |
          </details>
      
      detailed:
        condition: "Complex implementation, planning, or troubleshooting"
        format: |
          ## ğŸ’¬ Response
          {natural_language_explanation}
          
          ### {section_heading}
          {section_content}
        guidelines:
          - "Use subsections for logical grouping"
          - "Lead each section with summary sentence"
          - "Use lists for steps/items"
          - "Add visual indicators (âœ… âš ï¸ âŒ) for status"
        example: |
          ## ğŸ’¬ Response
          I'll implement authentication using three phases: foundation, core logic, and integration.
          
          ### Phase 1: Foundation
          - âœ… Create base structure in `src/auth/`
          - âœ… Set up test framework with fixtures
          - â³ Initialize authentication service interface
          
          ### Phase 2: Core Logic (Next)
          - JWT token generation with 24h expiration
          - Password hashing using bcrypt (cost factor 12)
          - Session management with Redis backend
      
      visual:
        condition: "Status, metrics, comparisons, test results"
        format: |
          ## ğŸ’¬ Response
          {brief_context}
          
          | {column} | {column} | {column} |
          |----------|----------|----------|
          | {data}   | {data}   | {data}   |
        guidelines:
          - "Lead with 1-sentence context"
          - "Use table for structured data"
          - "Add progress bars for percentages: â–“â–“â–“â–“â–‘â–‘â–‘â–‘â–‘â–‘"
          - "Use emojis for quick scanning: ğŸŸ¢ ğŸŸ¡ ğŸ”´"
        example: |
          ## ğŸ’¬ Response
          Test execution complete. 7 bugs fixed across 3 categories.
          
          | Category | Fixed | Status |
          |----------|-------|--------|
          | API Contracts | 6 | ğŸŸ¢ Complete |
          | Fixture Isolation | 1 | ğŸŸ¢ Complete |
          | Pass Rate | 40%â†’70%â†’100% | â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“ |
    
    code_display_rules:
      
      none:
        condition: "Explanation sufficient, no code needed"
        guideline: "Default for most responses - explain what, not how"
        
      pseudocode:
        condition: "Logic flow needs illustration"
        format: |
          ```
          IF user authenticated
            ALLOW dashboard access
          ELSE
            REDIRECT to login
          ```
        guideline: "High-level logic, no syntax"
        
      snippet:
        condition: "Key code change to show"
        format: |
          ```python
          # Key change: Use bcrypt instead of SHA-256
          hashed = bcrypt.hashpw(password, bcrypt.gensalt(12))
          ```
        guideline: "5-10 lines max, show critical part only"
        
      full_code:
        condition: "User explicitly requests code OR complex implementation"
        format: |
          <details>
          <summary>ğŸ”§ <strong>Implementation Code</strong></summary>
          
          ```python
          {full_implementation}
          ```
          </details>
        guideline: "Hide in collapsible section, include only when necessary"
    
    intelligent_routing:
      decision_tree: |
        1. Assess request complexity:
           - Simple query (status, what is, help) â†’ concise
           - Quick action completed â†’ concise or summarized
           - Multi-part work â†’ summarized (summary + collapsible details)
           - Complex implementation â†’ detailed (with subsections)
           - Data/metrics â†’ visual (tables, progress bars)
        
        2. Determine code display:
           - IF implementation request â†’ show pseudocode OR snippet
           - IF user says "show code" â†’ full_code
           - ELSE â†’ none (explain in natural language)
        
        3. Balance detail:
           - Lead with essential information (above the fold)
           - Hide supporting details in <details> tags
           - Add "Ask about [X] for details" prompts
           - Trust user to ask follow-ups if needed
  
  # Request Echo section - Confirm understanding
  request_echo:
    format: |
      ## ğŸ“ Your Request
      {refined_request}
    
    guidelines:
      - "MUST appear between Response and Next Steps"
      - "One sentence refinement of user's request"
      - "No colon after 'Your Request' (heading format)"
      - "Keep under 80 characters"
    
    placement: "Between response and next_steps"
    
    placeholders:
      refined_request: "Concise summary of user's request"
    
    max_length: 80
    
    example: |
      ## ğŸ“ Your Request
      Implement user authentication with JWT and session management
  
  # Next Steps section - Actionable recommendations
  next_steps:
    format: |
      ## ğŸ” Next Steps
      {context_specific_format}
    
    guidelines:
      - "Format depends on work type (simple/phases/tracks/milestones)"
      - "Use collapsible sections for complex breakdowns"
      - "Indicate time estimates when appropriate"
      - "Show when tasks can run in parallel"
      - "End with a clear call-to-action question"
    
    formats:
      simple_list:
        description: "For quick, independent actions"
        format: |
          1. **{action}** - {description}
          2. **{action}** - {description}
          3. **{action}** - {description}
        example: |
          ## ğŸ” Next Steps
          
          1. **Review README** - Check current content
          2. **Update features** - Add new CORTEX 2.0 capabilities
          3. **Refresh examples** - Use latest syntax
      
      phase_based:
        description: "For complex projects with multiple phases"
        format: |
          <details>
          <summary><strong>â˜ Phase {number}: {name}</strong> ({duration})</summary>
          
          - {task}
          - {task}
          </details>
        example: |
          ## ğŸ” Next Steps
          
          <details>
          <summary><strong>â˜ Phase 1: Foundation & Setup</strong> (2 hours)</summary>
          
          - Create module structure in `src/auth/`
          - Initialize test suite (`tests/test_auth.py`)
          - Set up fixtures and mocks
          </details>
          
          <details>
          <summary><strong>â˜ Phase 2: Core Implementation</strong> (4 hours)</summary>
          
          - Write failing tests (RED)
          - Implement functionality (GREEN)
          - Refactor for quality (REFACTOR)
          </details>
          
          ---
          
          **Ready to begin Phase 1?**
      
      parallel_tracks:
        description: "For independent work that can run simultaneously"
        format: |
          **Track {letter}: {name}** ({duration})
          - {task}
          - {task}
          
          These tracks are independent and can run in parallel.
          Which track(s) shall I start with? (You can choose multiple or ALL)
        example: |
          ## ğŸ” Next Steps
          
          **Track A: Fix configuration issue** (30 min)
          - Update `mkdocs.yml` Python path
          - Test build locally
          
          **Track B: Address broken links** (45 min)
          - Scan for 404s
          - Update references
          
          **Track C: Update navigation** (1 hour)
          - Restructure docs hierarchy
          - Generate new nav tree
          
          These tracks are independent and can run in parallel.
          Which track(s) shall I start with? (You can choose multiple or ALL)
      
      milestone_based:
        description: "For architecture/design work with clear milestones"
        format: |
          **â˜ Milestone {number}: {name}**
          - {deliverable}
          - {deliverable}
          
          Which milestone(s) would you like to tackle first?
        example: |
          ## ğŸ” Next Steps
          
          **â˜ Milestone 1: Architecture Design & Documentation**
          - System architecture diagram (Mermaid)
          - API contract specification (OpenAPI)
          - Database schema design (ERD)
          
          **â˜ Milestone 2: API Contracts & Integration Points**
          - REST endpoint definitions
          - Authentication flow diagram
          - Error handling strategy
          
          **â˜ Milestone 3: Implementation & Testing Strategy**
          - Test plan with coverage targets
          - CI/CD pipeline configuration
          - Deployment checklist
          
          Which milestone(s) would you like to tackle first?
    
    placeholders:
      context_specific_format: "Appropriate format based on work type"

# ============================================================================
# OPTIONAL SECTIONS
# ============================================================================

optional_sections:
  
  context_summary:
    description: "Show what CORTEX remembered from past conversations"
    format: |
      <details>
      <summary>ğŸ§  <strong>Context Memory</strong> ({conversation_count} conversations loaded, Quality: {quality_score}/10 {quality_emoji})</summary>
      
      **Freshness:** {freshness_label} ({hours_since_last}h ago)  
      **Entity Coverage:** {entity_coverage}%  
      **Relevance Score:** {avg_relevance_score}/1.0 ({relevance_label})  
      **Memory Health:** {memory_health}
      
      **Performance Metrics:**
      - Average query time: {avg_query_time}ms
      - Token usage: {token_usage}/{token_budget} ({token_percentage}%)
      - Storage health: {storage_health}
      
      *Use `show context` for detailed view*
      </details>
    
    placement: "After Response, before Request Echo"
    condition: "Only show if conversation quality â‰¥ GOOD threshold"
    
    example: |
      <details>
      <summary>ğŸ§  <strong>Context Memory</strong> (3 conversations loaded, Quality: 8/10 ğŸŸ¢)</summary>
      
      **Freshness:** Recent (2h ago)  
      **Entity Coverage:** 85%  
      **Relevance Score:** 0.78/1.0 (High)  
      **Memory Health:** Healthy
      
      **Performance Metrics:**
      - Average query time: 127ms
      - Token usage: 324/500 (64.8%)
      - Storage health: Optimal
      
      *Use `show context` for detailed view*
      </details>
  
  smart_hint:
    description: "Learning opportunity suggestion for high-quality conversations"
    format: |
      > ### ğŸ’¡ CORTEX Learning Opportunity
      > 
      > **This conversation has exceptional strategic value:**
      > {value_indicators}
      > 
      > **Quality Score: {score}/10 ({label})**
      > 
      > ğŸ“ **To capture this conversation:**  
      > Save conversation to file, then:
      > ```
      > capture conversation #file:cortex-brain/documents/conversation-captures/{filename}.md
      > ```
      > 
      > *CORTEX will import directly to brain (Tier 1), extract entities, and learn patterns.*
    
    placement: "After Next Steps (final section)"
    condition: "Only show if conversation quality â‰¥ EXCELLENT threshold"
    
    example: |
      > ### ğŸ’¡ CORTEX Learning Opportunity
      > 
      > **This conversation has exceptional strategic value:**
      > - Multi-phase planning with clear execution
      > - Challenge/Accept reasoning throughout
      > - Design decisions documented
      > - Complete implementation with tests
      > 
      > **Quality Score: 12/10 (EXCELLENT)**
      > 
      > ğŸ“ **To capture this conversation:**  
      > Save conversation to file, then:
      > ```
      > capture conversation #file:cortex-brain/documents/conversation-captures/2025-11-20-authentication.md
      > ```
      > 
      > *CORTEX will import directly to brain (Tier 1), extract entities, and learn patterns.*

# ============================================================================
# MARKDOWN ELEMENTS LIBRARY
# ============================================================================

markdown_elements:
  
  headings:
    h1: "# Title"
    h2: "## Section"
    h3: "### Subsection"
    h4: "#### Detail"
    usage: "One H1 per response, H2 for major sections, H3 for subsections"
  
  emphasis:
    bold: "**text**"
    italic: "*text*"
    bold_italic: "***text***"
    usage: "Bold for key terms, italic for subtle emphasis"
  
  lists:
    unordered: "- Item"
    ordered: "1. Item"
    nested: "  - Nested item (2 spaces)"
    checklist: "- [ ] Task"
    usage: "Unordered for items, ordered for steps, checklist for progress"
  
  code:
    inline: "`code`"
    block: "```language\ncode\n```"
    supported_languages:
      - python
      - javascript
      - typescript
      - bash
      - yaml
      - json
      - markdown
      - sql
    usage: "Inline for file names/commands, block for code examples"
  
  tables:
    simple: |
      | Column 1 | Column 2 |
      |----------|----------|
      | Value 1  | Value 2  |
    aligned: |
      | Left | Center | Right |
      |:-----|:------:|------:|
      | L    |   C    |     R |
    usage: "Use for structured data, test results, comparisons"
  
  links:
    inline: "[text](url)"
    reference: "[text][ref]\n\n[ref]: url"
    usage: "Inline for single links, reference for multiple uses"
  
  quotes:
    simple: "> Quote"
    multi_line: "> Line 1\n> Line 2"
    nested: "> Level 1\n>> Level 2"
    usage: "Use for important callouts or quoted content"
  
  horizontal_rules:
    format: "---"
    usage: "Use sparingly to separate major sections (max 2 per response)"
  
  collapsible:
    format: |
      <details>
      <summary>Title</summary>
      
      Content here
      </details>
    usage: "For complex information, phase breakdowns, context details"
  
  html_elements:
    bold: "<strong>text</strong>"
    emphasis: "<em>text</em>"
    break: "<br>"
    usage: "Use markdown equivalents when possible, HTML for special cases"

# ============================================================================
# VISUAL INDICATORS
# ============================================================================

visual_indicators:
  
  status_emojis:
    success: "âœ…"
    warning: "âš ï¸"
    error: "âŒ"
    info: "â„¹ï¸"
    in_progress: "â³"
    blocked: "ğŸš«"
    complete: "âœ”ï¸"
    pending: "â¸ï¸"
  
  category_emojis:
    brain: "ğŸ§ "
    target: "ğŸ¯"
    response: "ğŸ’¬"
    request: "ğŸ“"
    next_steps: "ğŸ”"
    security: "ğŸ”’"
    test: "ğŸ§ª"
    code: "ğŸ’»"
    docs: "ğŸ“š"
    bug: "ğŸ›"
    feature: "âœ¨"
    performance: "âš¡"
    database: "ğŸ—„ï¸"
    api: "ğŸ”Œ"
    cloud: "â˜ï¸"
  
  progress_indicators:
    full: "â–“"
    empty: "â–‘"
    bar_10: "â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“"
    bar_50: "â–“â–“â–“â–“â–“â–‘â–‘â–‘â–‘â–‘"
    bar_100: "â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“ 100%"
  
  quality_indicators:
    excellent: "ğŸŸ¢"
    good: "ğŸŸ¡"
    fair: "ğŸŸ "
    poor: "ğŸ”´"
    
  checkbox_states:
    unchecked: "â˜"
    checked: "â˜‘"
    partial: "â—"

# ============================================================================
# FORMATTING RULES
# ============================================================================

formatting_rules:
  
  prohibited:
    - "âŒ NEVER use separator lines (â”â”â”, â•â•â•, â”€â”€â”€, ___, -----)"
    - "âŒ NEVER use empty file links []()"
    - "âŒ NEVER narrate tool calls ('Read...', 'Searched text for...')"
    - "âŒ NEVER use over-enthusiastic comments ('Perfect!', 'Excellent!')"
    - "âŒ NEVER show code unless requested"
    - "âŒ NEVER duplicate header sections"
  
  required:
    - "âœ… ALWAYS use proper heading hierarchy"
    - "âœ… ALWAYS include request echo between Response and Next Steps"
    - "âœ… ALWAYS use markdown tables for structured data"
    - "âœ… ALWAYS use collapsible sections for complex information"
    - "âœ… ALWAYS use visual indicators for status"
    - "âœ… ALWAYS end with clear call-to-action"
  
  best_practices:
    - "Use emojis consistently for visual anchoring"
    - "Keep paragraphs short (2-3 sentences max)"
    - "Use bold for key terms, not decoration"
    - "Tables should have headers and alignment"
    - "Code blocks should specify language"
    - "Lists should be parallel in structure"
    - "Maintain professional, measured tone"
    - "Focus on WHAT was done, not HOW"

# ============================================================================
# PERFORMANCE TARGETS
# ============================================================================

performance:
  token_budget:
    base_template: 250
    with_mixin: 400
    max_per_response: 1000
    
  rendering:
    target_time: "<100ms"
    cache_hit_rate: ">90%"
    
  readability:
    heading_depth: "max 4 levels"
    paragraph_length: "2-3 sentences"
    sentence_length: "15-20 words average"
    
  quality:
    user_comprehension: ">95% (3 second scan)"
    action_clarity: "100% (clear next step)"
    professional_tone: "maintained throughout"

# ============================================================================
# INTELLIGENT ADAPTATION EXAMPLES
# ============================================================================

adaptation_examples:
  
  example_1_simple_query:
    user_request: "What's the status of CORTEX 3.0?"
    context:
      complexity: simple
      type: informational
      density: low
    
    template_selection:
      understanding: "One sentence"
      challenge: "none (skip section)"
      response: "concise (2-3 sentences)"
      code: "none"
      next_steps: "simple_list (if any)"
    
    rendered_output: |
      # ğŸ§  CORTEX Status Check
      **Author:** Asif Hussain | Â© 2024-2025 | github.com/asifhussain60/CORTEX
      
      ## ğŸ¯ My Understanding Of Your Request
      You want the current implementation status of CORTEX 3.0.
      
      ## ğŸ’¬ Response
      CORTEX 3.0 Phase 0 complete (100% test pass rate). Tier 0-1 operational. Tier 2-3 in development (Track A 60% complete).
      
      *Ask about specific phases or tracks for details.*
      
      ## ğŸ“ Your Request
      Check CORTEX 3.0 status
      
      ## ğŸ” Next Steps
      1. **Review progress** - See `PHASE-0-COMPLETION-REPORT.md`
      2. **Check roadmap** - View remaining Track A/B milestones
      3. **Run health check** - Validate local installation
    
    token_count: 247
    notes: "Challenge section omitted - no validation needed for simple query"
  
  example_2_completed_work:
    user_request: "Did the authentication implementation finish?"
    context:
      complexity: moderate
      type: actionable
      density: medium
    
    template_selection:
      understanding: "One sentence"
      challenge: "none (skip section)"
      response: "summarized (summary + collapsible details)"
      code: "none"
      next_steps: "simple_list"
    
    rendered_output: |
      # ğŸ§  CORTEX Implementation Status
      **Author:** Asif Hussain | Â© 2024-2025 | github.com/asifhussain60/CORTEX
      
      ## ğŸ¯ My Understanding Of Your Request
      You want confirmation that authentication implementation completed successfully.
      
      ## ğŸ’¬ Response
      âœ… Authentication complete. Implemented JWT tokens, session management, and password hashing. All 47 tests passing, coverage at 94%.
      
      <details>
      <summary>ğŸ“Š <strong>Implementation Details</strong></summary>
      
      | Component | Status | Coverage | Tests |
      |-----------|--------|----------|-------|
      | JWT Service | âœ… Complete | 96% | 18/18 âœ… |
      | Session Manager | âœ… Complete | 92% | 15/15 âœ… |
      | Password Hashing | âœ… Complete | 98% | 14/14 âœ… |
      
      **Files Modified:**
      - `src/auth/jwt_service.py` (new)
      - `src/auth/session_manager.py` (new)
      - `src/auth/password_hasher.py` (new)
      - `tests/test_auth.py` (new, 47 tests)
      </details>
      
      *Ask about deployment or integration steps.*
      
      ## ğŸ“ Your Request
      Confirm authentication implementation status
      
      ## ğŸ” Next Steps
      1. **Review code** - Check `src/auth/` implementation
      2. **Test locally** - Run `pytest tests/test_auth.py`
      3. **Deploy to staging** - Ready for staging environment
    
    token_count: 412
    notes: "Summary visible, details hidden. No challenge section (status check)."
  
  example_3_recommendation_needed:
    user_request: "Use MD5 for password hashing in authentication"
    context:
      complexity: simple
      type: actionable
      density: low
    
    template_selection:
      understanding: "One sentence"
      challenge: "challenge_only (security concern)"
      response: "concise"
      code: "snippet (show better approach)"
      next_steps: "simple_list"
    
    rendered_output: |
      # ğŸ§  CORTEX Authentication Implementation
      **Author:** Asif Hussain | Â© 2024-2025 | github.com/asifhussain60/CORTEX
      
      ## ğŸ¯ My Understanding Of Your Request
      You want to use MD5 for password hashing.
      
      ## âš¡ Recommendation
      MD5 is cryptographically broken and vulnerable to rainbow table attacks.
      
      ### ğŸ’¡ Better Approach
      **Use bcrypt** - Industry standard with adaptive cost factor, resistant to GPU attacks:
      
      ```python
      import bcrypt
      
      # Hash password
      hashed = bcrypt.hashpw(password.encode(), bcrypt.gensalt(12))
      
      # Verify password
      if bcrypt.checkpw(password.encode(), hashed):
          # Authentication successful
      ```
      
      ## ğŸ’¬ Response
      I'll implement password hashing using bcrypt with cost factor 12 (OWASP recommended). This provides strong security with acceptable performance.
      
      ## ğŸ“ Your Request
      Implement password hashing
      
      ## ğŸ” Next Steps
      1. **Install bcrypt** - Run `pip install bcrypt`
      2. **Implement hashing** - Add to `src/auth/password_hasher.py`
      3. **Write tests** - Verify hash/verify functions
    
    token_count: 389
    notes: "Challenge only (no accept). Code snippet shown for better approach."
  
  example_4_complex_implementation:
    user_request: "Implement user dashboard with charts and filters"
    context:
      complexity: complex
      type: planning
      density: high
    
    template_selection:
      understanding: "One sentence"
      challenge: "accept_only (request is sound)"
      response: "detailed (subsections + phases)"
      code: "pseudocode (logic flow)"
      next_steps: "phase_based (collapsible)"
    
    rendered_output: |
      # ğŸ§  CORTEX Feature Implementation
      **Author:** Asif Hussain | Â© 2024-2025 | github.com/asifhussain60/CORTEX
      
      ## ğŸ¯ My Understanding Of Your Request
      You want to implement a user dashboard with interactive charts and data filtering capabilities.
      
      ## âœ“ Proceeding
      Standard dashboard pattern with established libraries (Chart.js, React). All dependencies validated.
      
      ## ğŸ’¬ Response
      I'll implement the dashboard using three phases: UI foundation, data integration, and interactivity.
      
      ### Phase 1: UI Foundation
      - âœ… Create dashboard layout with responsive grid
      - âœ… Set up Chart.js for visualizations
      - â³ Build filter panel component
      
      ### Phase 2: Data Integration
      - Fetch user data from API endpoints
      - Transform data for chart consumption
      - Implement caching strategy (Redis)
      
      ```
      API â†’ Data Transform â†’ Chart Render
       â†“
      Cache (Redis) â†’ Filter â†’ Update Charts
      ```
      
      ### Phase 3: Interactivity
      - Connect filters to chart updates
      - Add date range picker
      - Implement export functionality (CSV/PDF)
      
      <details>
      <summary>ğŸ“Š <strong>Technical Architecture</strong></summary>
      
      | Component | Technology | Status |
      |-----------|-----------|--------|
      | Frontend | React 18 | âœ… Ready |
      | Charts | Chart.js 4.x | âœ… Ready |
      | API | FastAPI | âœ… Existing |
      | Cache | Redis | â³ Setup needed |
      | Export | jsPDF + PapaParse | â³ Install needed |
      </details>
      
      *Ask about specific components or technical decisions.*
      
      ## ğŸ“ Your Request
      Implement user dashboard with charts and filters
      
      ## ğŸ” Next Steps
      
      <details>
      <summary><strong>â˜ Phase 1: UI Foundation</strong> (4 hours)</summary>
      
      - Create `src/dashboard/` directory structure
      - Build responsive grid layout
      - Set up Chart.js with sample data
      - Implement filter panel UI
      </details>
      
      <details>
      <summary><strong>â˜ Phase 2: Data Integration</strong> (3 hours)</summary>
      
      - Create API endpoints for dashboard data
      - Set up Redis caching
      - Transform data for charts
      - Write integration tests
      </details>
      
      <details>
      <summary><strong>â˜ Phase 3: Interactivity</strong> (3 hours)</summary>
      
      - Connect filters to data fetching
      - Implement real-time chart updates
      - Add export functionality
      - End-to-end testing
      </details>
      
      ---
      
      **Ready to begin Phase 1?**
    
    token_count: 687
    notes: "Detailed response with subsections, pseudocode for flow, collapsible phases."
  
  example_5_test_results:
    user_request: "Show me the test results"
    context:
      complexity: simple
      type: analytical
      density: high
    
    template_selection:
      understanding: "One sentence"
      challenge: "none (skip section)"
      response: "visual (tables, progress bars)"
      code: "none"
      next_steps: "simple_list"
    
    rendered_output: |
      # ğŸ§  CORTEX Test Results
      **Author:** Asif Hussain | Â© 2024-2025 | github.com/asifhussain60/CORTEX
      
      ## ğŸ¯ My Understanding Of Your Request
      You want the latest test execution results.
      
      ## ğŸ’¬ Response
      
      **Overall:** 834/834 passing âœ… | 63 skipped âš ï¸ | 0 failures âŒ
      
      **Pass Rate:** â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“ 100% (of non-skipped)
      
      | Category | Tests | Passing | Coverage |
      |----------|-------|---------|----------|
      | Unit Tests | 547 | 547 âœ… | ğŸŸ¢ 92% |
      | Integration Tests | 287 | 287 âœ… | ğŸŸ¡ 78% |
      | Skipped (Future) | 63 | N/A | - |
      
      <details>
      <summary>ğŸ“‹ <strong>Skipped Test Breakdown</strong></summary>
      
      | Reason | Count | Milestone |
      |--------|-------|-----------|
      | Session Management | 19 | Phase 2 |
      | CSS/UI Validation | 20 | 3.1+ |
      | Namespace Protection | 6 | Phase 3 |
      | Integration Edge Cases | 18 | Phase 5 |
      </details>
      
      *Ask about specific test categories for details.*
      
      ## ğŸ“ Your Request
      Show test results
      
      ## ğŸ” Next Steps
      1. **Review skipped tests** - See deferral reasons in `test-strategy.yaml`
      2. **Check coverage gaps** - Integration tests at 78% (target: 85%)
      3. **Run full suite** - Execute `pytest -v` for detailed output
    
    token_count: 394
    notes: "Visual format with tables and progress bars. Challenge section omitted."

# ============================================================================
# ADAPTATION DECISION TREE
# ============================================================================

adaptation_decision_tree:
  
  step_1_assess_request:
    questions:
      - "Is this a simple query (status, help, what is)?"
      - "Is this a completed work report?"
      - "Is this a complex implementation or planning?"
      - "Is this data/metrics display?"
    
    outcomes:
      simple_query: "Use concise format"
      completed_work: "Use summarized format"
      complex_work: "Use detailed format"
      data_display: "Use visual format"
  
  step_2_validate_assumptions:
    questions:
      - "Does user reference files/components that need validation?"
      - "Are there security/performance concerns?"
      - "Is there a better approach?"
    
    outcomes:
      no_concerns: "Skip challenge section OR use accept_only"
      minor_concerns: "Use mixed (accept + recommended change)"
      major_concerns: "Use challenge_only (recommend alternative)"
  
  step_3_determine_code_display:
    questions:
      - "Can concept be explained without code?"
      - "Does user explicitly request code?"
      - "Would pseudocode clarify logic?"
      - "Is there a key snippet to show?"
    
    outcomes:
      no_code: "Explain in natural language (default)"
      pseudocode: "Show high-level logic flow"
      snippet: "Show 5-10 line critical change"
      full_code: "Show in collapsible section"
  
  step_4_format_response:
    rules:
      - "Lead with summary (always visible)"
      - "Hide details in collapsible sections"
      - "Use tables for structured data"
      - "Add 'Ask about X' prompts"
      - "Keep total under 1000 tokens"

# ============================================================================
# ANTI-PATTERNS TO AVOID
# ============================================================================

anti_patterns:
  
  forced_challenge:
    wrong: |
      ## âš ï¸ Challenge: âœ“ Accept
      This is fine.
    right: |
      ## âœ“ Proceeding
      Standard approach, all dependencies validated.
    explanation: "Don't force-display both options. Skip challenge section if nothing to challenge."
  
  verbose_explanation:
    wrong: |
      I analyzed the request thoroughly by examining each component individually,
      validating all assumptions, checking dependencies, reviewing best practices,
      and finally determining the optimal approach... [5 paragraphs]
    right: |
      Analyzed request. All dependencies validated. Proceeding with implementation.
    explanation: "Users want answers, not process narration."
  
  code_dump:
    wrong: |
      Here's the complete implementation:
      [100 lines of code in response]
    right: |
      Implemented authentication with JWT tokens.
      
      <details>
      <summary>ğŸ”§ <strong>Implementation Code</strong></summary>
      
      ```python
      [code here]
      ```
      </details>
    explanation: "Hide code in collapsible section. Most users just want confirmation."
  
  buried_critical_info:
    wrong: |
      [3 paragraphs of background]
      [2 paragraphs of approach]
      âŒ CRITICAL: Database migration will cause 10 minutes downtime
      [2 more paragraphs]
    right: |
      âš ï¸ **CRITICAL:** Database migration will cause 10 minutes downtime
      
      [implementation details follow]
    explanation: "Critical information first, always above the fold."

version_history:
  "2.0.0":
    date: "2025-11-20"
    changes:
      - "Complete redesign for markdown-first approach"
      - "Added heading hierarchy (# ## ###)"
      - "Introduced collapsible sections"
      - "Enhanced visual indicators"
      - "Improved table formatting"
      - "Added progressive disclosure pattern"
    breaking_changes:
      - "Changed from bold formatting (**Section:**) to heading format (## Section)"
      - "Removed separator lines (---, ===)"
      - "Updated section order and naming"
  
  "1.0.0":
    date: "2025-11-08"
    changes:
      - "Initial template system with 18 templates"
      - "Basic structure with bold section markers"
      - "Token optimization strategy"
