# CORTEX Protection Layer: Commit Integrity
# Extracted from brain-protection-rules.yaml for token optimization
# Version: 2.1
# Part of: CORTEX 3.0 Track B (Token Optimization)

version: "2.1"
type: "protection_layer"
layer_id: "commit_integrity"
parent_file: "brain-protection-rules.yaml"

# Layer definition (normalized indentation)
- layer_id: "commit_integrity"
  name: "Commit Integrity"
  description: "Brain state files excluded from commits"
  priority: 7

  rules:
    - rule_id: "BRAIN_STATE_GITIGNORE"
      name: "Brain State Files Not Committed"
      severity: "warning"
      description: "Brain state file should not be committed"

      detection:
        files: "{{brain_state_files}}"
        keywords:
          - "commit"
        scope: ["intent"]

      alternatives:
        - "Add to .gitignore"
        - "Keep local-only"
        - "Export as snapshot if needed for sharing"

      evidence: "Add to .gitignore to prevent pollution"

    - rule_id: "TEMP_FILES_COMMIT"
      name: "Temporary Files Not Committed"
      severity: "warning"
      description: "Temporary or generated files should not be committed"

      detection:
        path_patterns:
          - "**/*.tmp"
          - "**/temp_*"
          - "**/__pycache__/**"
          - "**/node_modules/**"
        keywords:
          - "commit"
        scope: ["intent"]

      alternatives:
        - "Update .gitignore"
        - "Clean before commit"
        - "Use .gitkeep for empty directories"

      evidence: "Temporary files pollute repository"

# Layer 8: Git Isolation (CRITICAL)
