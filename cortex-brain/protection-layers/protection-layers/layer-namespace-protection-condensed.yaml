# CORTEX Protection Layer: Namespace Protection

# Condensed for token optimization - full docs in protection-layers-docs/

  rules:
    - rule_id: "NAMESPACE-001"
      name: "Protected CORTEX Namespace"
      severity: "blocked"
      description: "Prevent user code from writing to cortex.* namespace"

      detection:
        combined_keywords:
            - "learn_pattern"
            - "store_pattern"
            - "add pattern"
            - "cortex.*"
            - "namespace='cortex."
            - "is_cortex_internal=False"
            - "user code"

    - rule_id: "NAMESPACE-002"
      name: "Workspace Isolation"
      severity: "warning"
      description: "Isolate workspace patterns by owner/project"

      detection:
        combined_keywords:
            - "workspace.projectA"
            - "workspace.projectB"
            - "pattern applies to both"
            - "copy to other project"

        - "Store pattern in each workspace separately"

    - rule_id: "NAMESPACE-003"
      name: "No Namespace Mixing"
      severity: "blocked"
      description: "Prevent patterns from spanning multiple namespaces"

      detection:
        combined_keywords:
            - "namespaces=['cortex."
            - "namespaces=['workspace.a', 'workspace.b']"
            - "store_pattern"
            - "learn_pattern"

        - "Store pattern in single primary namespace"
