# CORTEX Tier 0 Rulebook
# Immutable instincts that apply across all phases and agents

rules:
  - id: PHASE_GIT_CHECKPOINT
    tier: 0
    severity: HIGH
    category: version_control
    description: >-
      At the end of EVERY phase, CORTEX MUST create a Git checkpoint consisting of
      a commit on the active branch and a push to origin. Optionally, create a
      lightweight tag for easy retrieval. This ensures traceable, incremental
      delivery across phases and prevents untracked drift.
    enforcement:
      when: "phase_exit"  # applies to phases -2, -1, 0, 0.5, 1, 2, 3, 4, 5, 6
      steps:
        - validate_success_criteria: true   # phase success criteria, quality gates pass
        - commit:
            required: true
            message_format: "chore(phase-X): complete Phase X — <summary>"
            body_guidance:
              - "benchmarks or results"
              - "schema/tag versions if applicable"
              - "docs updated (MkDocs/build status)"
        - push:
            required: true
            remote: origin
            ref: HEAD
        - tag:
            optional: true
            format: "phase-X-complete"
            annotate: true
        - changelog:
            required: true
            file: "cortex-design/CHANGELOG.md"
            entry_format: "Phase X — <summary> (date, key artifacts)"
    validation:
      - check_uncommitted_count_is_zero
      - confirm_remote_push_succeeded
      - if_tag_created_then_remote_tag_exists
      - changelog_contains_phase_entry
    related:
      - IMPLEMENTATION_PLAN: cortex-design/IMPLEMENTATION-PLAN-V2.md
      - CI_RULES: .github/workflows/cortex-ci.yml
    failure_behavior:
      on_commit_failure: HALT
      on_push_failure: HALT
      on_validation_warning: PROMPT_USER

  # Reserved for future additions to the Tier 0 rulebook
  - id: RESERVED
    tier: 0
    severity: LOW
    description: "Placeholder for additional Tier 0 rules."
