# CORTEX Response Templates v3.0 - Intelligent Adaptation System
# 
# This file contains intelligently-adapted templates that automatically adjust
# verbosity, format, and challenge sections based on context.
#
# Author: Asif Hussain | Â© 2024-2025
# Created: 2025-11-20
# Version: 3.0.0

schema_version: "3.0.0"
created: "2025-11-20"
last_updated: "2025-11-20"

# ============================================================================
# ADAPTATION ENGINE CONFIGURATION
# ============================================================================

adaptation_config:
  enabled: true
  default_format: "auto"  # auto, concise, summarized, detailed, visual
  challenge_intelligence: true
  code_display_intelligence: true
  progressive_disclosure: true
  token_budget_enforcement: true
  max_tokens_per_response: 1000

# ============================================================================
# CATEGORY 1: SIMPLE INFORMATION TEMPLATES (CONCISE FORMAT)
# ============================================================================

templates:
  
  help_table:
    name: "Help Table - Quick Reference"
    version: "3.0"
    category: "information"
    trigger:
      - "help"
      - "/help"
      - "help table"
      - "what can cortex do"
    
    adaptation:
      format: "concise"
      challenge: "skip"  # No validation needed for help requests
      code_display: "none"
      verbosity: "minimal"
    
    structure:
      header:
        format: "# ğŸ§  CORTEX Quick Reference"
        include_author: true
      
      understanding:
        format: "## ğŸ¯ My Understanding Of Your Request"
        content: "You want a quick overview of CORTEX commands and capabilities."
        max_length: 80
      
      challenge:
        display: false  # Skip entirely for help requests
      
      response:
        format: "## ğŸ’¬ Response"
        style: "visual_table"
        content: |
          | Command | Purpose | Example |
          |---------|---------|---------|
          | **help** | Show this quick reference | "help" |
          | **plan [feature]** | Interactive planning | "plan authentication" |
          | **status** | Check CORTEX status | "status" |
          | **resume [work]** | Continue previous work | "resume authentication" |
          | **capture conversation** | Import to brain | "capture conversation #file:chat.md" |
          | **show context** | View remembered conversations | "show context" |
          
          *Ask "help detailed" for complete command list with examples.*
      
      request_echo:
        format: "## ğŸ“ Your Request"
        content: "Show CORTEX quick reference"
      
      next_steps:
        format: "## ğŸ” Next Steps"
        style: "simple_list"
        content: |
          1. **Try a command** - Pick any from the table above
          2. **Explore planning** - Say "plan a feature" for interactive planning
          3. **Get detailed help** - Say "help detailed" for full documentation
    
    token_budget: 320
    estimated_tokens: 310
  
  status_check:
    name: "Status Check"
    version: "3.0"
    category: "information"
    trigger:
      - "status"
      - "cortex status"
      - "what's the status"
      - "where are we"
    
    adaptation:
      format: "visual"
      challenge: "skip"
      code_display: "none"
      verbosity: "minimal"
    
    structure:
      header:
        format: "# ğŸ§  CORTEX Status Check"
        include_author: true
      
      understanding:
        format: "## ğŸ¯ My Understanding Of Your Request"
        content: "You want the current implementation status of CORTEX."
        max_length: 70
      
      challenge:
        display: false
      
      response:
        format: "## ğŸ’¬ Response"
        style: "visual_table"
        content: |
          **CORTEX 3.0 Status:** Phase 0 Complete (100% test pass rate)
          
          | Component | Status | Coverage |
          |-----------|--------|----------|
          | Tier 0 (Brain Protection) | âœ… Operational | 100% |
          | Tier 1 (Working Memory) | âœ… Operational | 94% |
          | Tier 2 (Knowledge Graph) | â³ Development | 60% |
          | Tier 3 (Long-term Memory) | â³ Planned | 0% |
          
          **Pass Rate:** â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“ 100% (834/834 non-skipped tests)
          
          *Ask about specific tiers or tracks for details.*
      
      request_echo:
        format: "## ğŸ“ Your Request"
        content: "Check CORTEX implementation status"
      
      next_steps:
        format: "## ğŸ” Next Steps"
        style: "simple_list"
        content: |
          1. **Review progress** - See `PHASE-0-COMPLETION-REPORT.md`
          2. **Check roadmap** - View remaining Track A/B milestones
          3. **Run health check** - Validate local installation
    
    token_budget: 400
    estimated_tokens: 390

  quick_start:
    name: "Quick Start Guide"
    version: "3.0"
    category: "information"
    trigger:
      - "quick start"
      - "get started"
      - "how to start"
      - "getting started"
    
    adaptation:
      format: "concise"
      challenge: "skip"
      code_display: "none"
      verbosity: "minimal"
    
    structure:
      header:
        format: "# ğŸ§  CORTEX Quick Start"
        include_author: true
      
      understanding:
        format: "## ğŸ¯ My Understanding Of Your Request"
        content: "You want to get started using CORTEX quickly."
        max_length: 60
      
      challenge:
        display: false
      
      response:
        format: "## ğŸ’¬ Response"
        style: "concise_with_steps"
        content: |
          Just tell CORTEX what you want in natural language. No commands to memorize.
          
          **Examples:**
          - "plan authentication feature"
          - "add a purple button to the dashboard"
          - "show me the test results"
          - "fix the broken navigation"
          
          CORTEX figures out what you need and routes to the appropriate agent automatically.
          
          *Say "help" for available commands or start with any request above.*
      
      request_echo:
        format: "## ğŸ“ Your Request"
        content: "Get started with CORTEX"
      
      next_steps:
        format: "## ğŸ” Next Steps"
        style: "simple_list"
        content: |
          1. **Try a request** - Use any example above
          2. **Explore planning** - Say "plan a feature" for guided planning
          3. **Enable tracking** - See `tracking-guide.md` for conversation memory
    
    token_budget: 350
    estimated_tokens: 320

# ============================================================================
# CATEGORY 2: COMPLETED WORK REPORTS (SUMMARIZED FORMAT)
# ============================================================================

  success_general:
    name: "Success - General"
    version: "3.0"
    category: "completion"
    trigger:
      - "success_general"
    
    adaptation:
      format: "summarized"
      challenge: "accept_only"
      code_display: "none"
      verbosity: "moderate"
    
    structure:
      header:
        format: "# ğŸ§  CORTEX {operation_type}"
        include_author: true
        placeholders: ["operation_type"]
      
      understanding:
        format: "## ğŸ¯ My Understanding Of Your Request"
        content: "{user_intent_summary}"
        placeholders: ["user_intent_summary"]
        max_length: 100
      
      challenge:
        display: true
        format: "## âœ“ Proceeding"
        style: "accept_only"
        content: "Standard completion, all checks passed."
        max_length: 60
      
      response:
        format: "## ğŸ’¬ Response"
        style: "summarized"
        content: |
          âœ… {operation_name} complete. {brief_summary}
          
          <details>
          <summary>ğŸ“Š <strong>Implementation Details</strong></summary>
          
          {detailed_breakdown}
          </details>
          
          *Ask about {follow_up_topic} for details.*
        placeholders: ["operation_name", "brief_summary", "detailed_breakdown", "follow_up_topic"]
      
      request_echo:
        format: "## ğŸ“ Your Request"
        content: "{refined_request}"
        placeholders: ["refined_request"]
        max_length: 80
      
      next_steps:
        format: "## ğŸ” Next Steps"
        style: "simple_list"
        content: "{context_specific_steps}"
        placeholders: ["context_specific_steps"]
    
    token_budget: 500
    estimated_tokens: 440

  operation_complete:
    name: "Operation Complete"
    version: "3.0"
    category: "completion"
    trigger:
      - "operation_complete"
    
    adaptation:
      format: "summarized"
      challenge: "accept_only"
      code_display: "none"
      verbosity: "moderate"
    
    structure:
      header:
        format: "# ğŸ§  CORTEX Operation Complete"
        include_author: true
      
      understanding:
        format: "## ğŸ¯ My Understanding Of Your Request"
        content: "{operation_description}"
        placeholders: ["operation_description"]
        max_length: 100
      
      challenge:
        display: true
        format: "## âœ“ Complete"
        style: "accept_only"
        content: "{completion_validation}"
        placeholders: ["completion_validation"]
        max_length: 80
      
      response:
        format: "## ğŸ’¬ Response"
        style: "summarized_with_phases"
        content: |
          {operation_summary}
          
          <details>
          <summary>ğŸ“‹ <strong>Phase Breakdown</strong></summary>
          
          | Phase | Status | Duration |
          |-------|--------|----------|
          {phase_table_rows}
          </details>
          
          *Ask about any phase for detailed breakdown.*
        placeholders: ["operation_summary", "phase_table_rows"]
      
      request_echo:
        format: "## ğŸ“ Your Request"
        content: "{refined_request}"
        placeholders: ["refined_request"]
        max_length: 80
      
      next_steps:
        format: "## ğŸ” Next Steps"
        style: "simple_list"
        content: "{context_specific_steps}"
        placeholders: ["context_specific_steps"]
    
    token_budget: 550
    estimated_tokens: 480

# ============================================================================
# CATEGORY 3: PLANNING & VALIDATION (DETAILED FORMAT)
# ============================================================================

  work_planner_success:
    name: "Work Planner - Planning Start"
    version: "3.0"
    category: "planning"
    trigger:
      - "work_planner_success"
    
    adaptation:
      format: "detailed"
      challenge: "intelligent"  # Challenge if DoR not met
      code_display: "pseudocode"
      verbosity: "high"
    
    structure:
      header:
        format: "# ğŸ§  CORTEX Feature Planning"
        include_author: true
      
      understanding:
        format: "## ğŸ¯ My Understanding Of Your Request"
        content: "You want to plan {feature_name} with structured approach and zero ambiguity."
        placeholders: ["feature_name"]
        max_length: 100
      
      challenge:
        display: true
        format: "## âš¡ DoR Validation Required"
        style: "challenge_required"
        content: |
          I need to ensure Definition of Ready (DoR) is met with zero ambiguity before proceeding.
          I will not move forward until all clarifying questions are answered.
        max_length: 150
      
      response:
        format: "## ğŸ’¬ Response"
        style: "detailed_with_phases"
        content: |
          Created planning file: `{planning_file_path}`
          
          Starting interactive planning session with DoR enforcement.
          
          ### ğŸ“‹ Definition of Ready Checklist
          
          {dor_checklist}
          
          <details>
          <summary>ğŸ’¡ <strong>Clarifying Questions</strong></summary>
          
          {clarifying_questions}
          </details>
          
          âš ï¸ **I will not proceed until DoR is met with zero ambiguity.**
        placeholders: ["planning_file_path", "dor_checklist", "clarifying_questions"]
      
      request_echo:
        format: "## ğŸ“ Your Request"
        content: "Plan {feature_name} with zero ambiguity"
        placeholders: ["feature_name"]
        max_length: 80
      
      next_steps:
        format: "## ğŸ” Next Steps"
        style: "checklist"
        content: "{dor_validation_steps}"
        placeholders: ["dor_validation_steps"]
    
    token_budget: 700
    estimated_tokens: 620

  planning_dor_complete:
    name: "Planning - DoR Complete"
    version: "3.0"
    category: "planning"
    trigger:
      - "planning_dor_complete"
    
    adaptation:
      format: "detailed"
      challenge: "accept_only"
      code_display: "pseudocode"
      verbosity: "high"
    
    structure:
      header:
        format: "# ğŸ§  CORTEX Planning - DoR Complete"
        include_author: true
      
      understanding:
        format: "## ğŸ¯ My Understanding Of Your Request"
        content: "All clarifying questions answered, DoR validation complete."
        max_length: 80
      
      challenge:
        display: true
        format: "## âœ“ DoR Met"
        style: "accept_only"
        content: "All requirements documented with zero ambiguity. Dependencies validated. Security review complete."
        max_length: 120
      
      response:
        format: "## ğŸ’¬ Response"
        style: "detailed_with_milestones"
        content: |
          âœ… **DoR Status: COMPLETE**
          
          {dor_completion_table}
          
          Generating detailed plan with:
          - Phase breakdown (Foundation â†’ Core â†’ Validation)
          - Risk analysis
          - Security hardening tasks
          - Task generation
          - Acceptance criteria
        placeholders: ["dor_completion_table"]
      
      request_echo:
        format: "## ğŸ“ Your Request"
        content: "Generate plan with DoR validated"
        max_length: 50
      
      next_steps:
        format: "## ğŸ” Next Steps"
        style: "milestone_based"
        content: |
          <details>
          <summary><strong>â˜ Milestone 1: Planning & Security Baseline</strong> (Complete)</summary>
          
          {milestone_1_tasks}
          </details>
          
          <details>
          <summary><strong>â˜ Milestone 2: Foundation & Discovery</strong></summary>
          
          {milestone_2_tasks}
          </details>
          
          <details>
          <summary><strong>â˜ Milestone 3: Core Implementation</strong></summary>
          
          {milestone_3_tasks}
          </details>
          
          ---
          
          **Review the planning document and say "approve plan" when ready.**
        placeholders: ["milestone_1_tasks", "milestone_2_tasks", "milestone_3_tasks"]
    
    token_budget: 700
    estimated_tokens: 580

# ============================================================================
# CATEGORY 4: ERRORS & ISSUES (VISUAL FORMAT)
# ============================================================================

  error_general:
    name: "Error - General"
    version: "3.0"
    category: "error"
    trigger:
      - "error_general"
    
    adaptation:
      format: "visual"
      challenge: "challenge_only"  # Always recommend fix
      code_display: "snippet"
      verbosity: "moderate"
    
    structure:
      header:
        format: "# ğŸ§  CORTEX Error Recovery"
        include_author: true
      
      understanding:
        format: "## ğŸ¯ My Understanding Of Your Request"
        content: "{error_context}"
        placeholders: ["error_context"]
        max_length: 100
      
      challenge:
        display: true
        format: "## âš¡ Issue Detected"
        style: "challenge_with_fix"
        content: |
          **Error:** {error_message}
          
          ### ğŸ’¡ Recommended Fix
          {recommended_fix}
        placeholders: ["error_message", "recommended_fix"]
      
      response:
        format: "## ğŸ’¬ Response"
        style: "visual_error_table"
        content: |
          | Severity | Component | Error | Fix |
          |----------|-----------|-------|-----|
          {error_table_row}
          
          <details>
          <summary>ğŸ” <strong>Error Details</strong></summary>
          
          ```
          {stack_trace_or_log}
          ```
          </details>
          
          *Ask about {troubleshooting_topic} if issue persists.*
        placeholders: ["error_table_row", "stack_trace_or_log", "troubleshooting_topic"]
      
      request_echo:
        format: "## ğŸ“ Your Request"
        content: "{refined_request}"
        placeholders: ["refined_request"]
        max_length: 80
      
      next_steps:
        format: "## ğŸ” Next Steps"
        style: "remediation_steps"
        content: "{recovery_steps}"
        placeholders: ["recovery_steps"]
    
    token_budget: 550
    estimated_tokens: 480

# ============================================================================
# FALLBACK TEMPLATE (INTELLIGENT ROUTING)
# ============================================================================

  help_detailed:
    name: "Help Detailed - Complete Command Reference"
    version: "3.0"
    category: "information"
    trigger:
      - "help detailed"
      - "detailed help"
      - "show all commands"
    
    adaptation:
      format: "concise"
      challenge: "skip"
      code_display: "none"
      verbosity: "moderate"
    
    structure:
      header:
        format: "# ğŸ§  CORTEX Complete Reference"
        include_author: true
      
      understanding:
        format: "## ğŸ¯ My Understanding Of Your Request"
        content: "You want detailed documentation of all CORTEX commands."
        max_length: 70
      
      challenge:
        display: false
      
      response:
        format: "## ğŸ’¬ Response"
        style: "categorized_with_collapsible"
        content: |
          <details>
          <summary><strong>ğŸš€ Core Commands</strong></summary>
          
          | Command | Purpose | Example |
          |---------|---------|---------|
          | **plan [feature]** | Interactive planning | "plan authentication" |
          | **status** | Check implementation status | "status" |
          | **resume [work]** | Continue previous work | "resume authentication" |
          </details>
          
          <details>
          <summary><strong>ğŸ§  Memory Commands</strong></summary>
          
          | Command | Purpose | Example |
          |---------|---------|---------|
          | **capture conversation** | Import to brain | "capture conversation #file:chat.md" |
          | **show context** | View remembered conversations | "show context" |
          | **forget [topic]** | Remove specific memory | "forget authentication" |
          </details>
          
          <details>
          <summary><strong>ğŸ“š Documentation Commands</strong></summary>
          
          | Command | Purpose | Example |
          |---------|---------|---------|
          | **generate docs** | Build documentation | "generate documentation" |
          | **refresh docs** | Update existing docs | "refresh docs" |
          </details>
          
          *See `CORTEX.prompt.md` for complete documentation.*
      
      request_echo:
        format: "## ğŸ“ Your Request"
        content: "Show complete command reference"
      
      next_steps:
        format: "## ğŸ” Next Steps"
        style: "simple_list"
        content: |
          1. **Try a command** - Pick from any category above
          2. **Explore modules** - See technical-reference.md for deep dive
          3. **Quick help** - Say "help" for condensed table
    
    token_budget: 450
    estimated_tokens: 420

  admin_help:
    name: "Admin Help - Internal Operations"
    version: "3.0"
    category: "information"
    trigger:
      - "admin help"
      - "help admin"
    
    adaptation:
      format: "visual"
      challenge: "skip"
      code_display: "none"
      verbosity: "moderate"
    
    structure:
      header:
        format: "# ğŸ§  CORTEX Admin Operations"
        include_author: true
      
      understanding:
        format: "## ğŸ¯ My Understanding Of Your Request"
        content: "You want admin-level operations including internal generators."
        max_length: 80
      
      challenge:
        display: false
      
      response:
        format: "## ğŸ’¬ Response"
        style: "visual_table"
        content: |
          âš ï¸ **Admin operations modify documentation artifacts directly.**
          
          | Trigger | Component | Purpose | Status |
          |---------|-----------|---------|--------|
          | generate diagrams | diagrams | Architecture & workflow diagrams | âœ… Ready |
          | generate mkdocs | mkdocs | MkDocs config & navigation | âœ… Ready |
          | generate feature list | feature_list | Capabilities reference | âœ… Ready |
          | generate executive summary | executive_summary | Project overview | âœ… Ready |
          | publish docs | publish | Deploy to GitHub Pages | âœ… Ready |
          | generate documentation | all | Run full pipeline | âœ… Ready |
          
          *Use responsibly - these commands overwrite existing files.*
      
      request_echo:
        format: "## ğŸ“ Your Request"
        content: "Access admin operations"
      
      next_steps:
        format: "## ğŸ” Next Steps"
        style: "simple_list"
        content: |
          1. **Run component** - Use any trigger above
          2. **Full regeneration** - Say "generate documentation"
          3. **Verify changes** - Review generated files after execution
    
    token_budget: 450
    estimated_tokens: 430

  executor_success:
    name: "Executor Success - Implementation Complete"
    version: "3.0"
    category: "completion"
    trigger:
      - "executor_success"
    
    adaptation:
      format: "summarized"
      challenge: "accept_only"
      code_display: "snippet"
      verbosity: "moderate"
    
    structure:
      header:
        format: "# ğŸ§  CORTEX Implementation Complete"
        include_author: true
      
      understanding:
        format: "## ğŸ¯ My Understanding Of Your Request"
        content: "{implementation_description}"
        placeholders: ["implementation_description"]
        max_length: 100
      
      challenge:
        display: true
        format: "## âœ“ Implementation Validated"
        style: "accept_only"
        content: "All tests passing, code quality checks passed."
        max_length: 60
      
      response:
        format: "## ğŸ’¬ Response"
        style: "summarized_with_table"
        content: |
          âœ… {feature_name} implemented successfully.
          
          | Component | Status | Tests | Coverage |
          |-----------|--------|-------|----------|
          {component_rows}
          
          <details>
          <summary>ğŸ”§ <strong>Implementation Details</strong></summary>
          
          **Files Modified:**
          {file_list}
          
          **Key Changes:**
          {key_changes}
          </details>
          
          *Ask about deployment or integration steps.*
      
      request_echo:
        format: "## ğŸ“ Your Request"
        content: "{refined_request}"
        placeholders: ["refined_request"]
        max_length: 80
      
      next_steps:
        format: "## ğŸ” Next Steps"
        style: "simple_list"
        content: "{next_step_recommendations}"
        placeholders: ["next_step_recommendations"]
    
    token_budget: 550
    estimated_tokens: 490

  tester_success:
    name: "Tester Success - Test Execution Complete"
    version: "3.0"
    category: "completion"
    trigger:
      - "tester_success"
    
    adaptation:
      format: "visual"
      challenge: "skip"
      code_display: "none"
      verbosity: "minimal"
    
    structure:
      header:
        format: "# ğŸ§  CORTEX Test Results"
        include_author: true
      
      understanding:
        format: "## ğŸ¯ My Understanding Of Your Request"
        content: "You want test execution results."
        max_length: 50
      
      challenge:
        display: false
      
      response:
        format: "## ğŸ’¬ Response"
        style: "visual_table"
        content: |
          **Overall:** {total_passing}/{total_tests} passing âœ… | {skipped} skipped âš ï¸ | {failures} failures âŒ
          
          **Pass Rate:** {progress_bar} {pass_percentage}%
          
          | Category | Tests | Passing | Coverage |
          |----------|-------|---------|----------|
          {test_category_rows}
          
          <details>
          <summary>ğŸ“‹ <strong>Detailed Breakdown</strong></summary>
          
          {detailed_test_breakdown}
          </details>
          
          *Ask about specific test categories for details.*
        placeholders: ["total_passing", "total_tests", "skipped", "failures", "progress_bar", "pass_percentage", "test_category_rows", "detailed_test_breakdown"]
      
      request_echo:
        format: "## ğŸ“ Your Request"
        content: "Show test results"
      
      next_steps:
        format: "## ğŸ” Next Steps"
        style: "simple_list"
        content: |
          1. **Review failures** - Check failed tests if any
          2. **Check coverage** - Review coverage gaps
          3. **Run specific tests** - Execute `pytest [test_file]`
    
    token_budget: 450
    estimated_tokens: 410

  ado_created:
    name: "ADO Created - Planning Template Ready"
    version: "3.0"
    category: "completion"
    trigger:
      - "ado_created"
    
    adaptation:
      format: "concise"
      challenge: "accept_only"
      code_display: "none"
      verbosity: "minimal"
    
    structure:
      header:
        format: "# ğŸ§  CORTEX ADO Planning"
        include_author: true
      
      understanding:
        format: "## ğŸ¯ My Understanding Of Your Request"
        content: "You want to create a new ADO work item with planning template."
        max_length: 80
      
      challenge:
        display: true
        format: "## âœ“ Template Ready"
        style: "accept_only"
        content: "ADO Planning System 2.0 with database storage active."
        max_length: 70
      
      response:
        format: "## ğŸ’¬ Response"
        style: "concise"
        content: |
          Created ADO work item: `{ado_file_path}`
          
          Planning template includes:
          â€¢ Definition of Ready (DoR) checklist
          â€¢ Acceptance criteria template
          â€¢ Technical notes section
          â€¢ Security review checklist
          
          *File opened in VS Code for customization.*
        placeholders: ["ado_file_path"]
      
      request_echo:
        format: "## ğŸ“ Your Request"
        content: "Create new ADO work item"
      
      next_steps:
        format: "## ğŸ” Next Steps"
        style: "simple_list"
        content: |
          1. **Customize template** - Fill in DoR, acceptance criteria, technical notes
          2. **Approve plan** - Say "approve ado [number]" when ready
          3. **Start work** - Say "resume ado [number]" to begin implementation
    
    token_budget: 400
    estimated_tokens: 370

  planning_dor_incomplete:
    name: "Planning DoR Incomplete - Validation Blocking"
    version: "3.0"
    category: "planning"
    trigger:
      - "planning_dor_incomplete"
    
    adaptation:
      format: "detailed"
      challenge: "challenge_only"
      code_display: "none"
      verbosity: "high"
    
    structure:
      header:
        format: "# ğŸ§  CORTEX Planning - DoR Incomplete"
        include_author: true
      
      understanding:
        format: "## ğŸ¯ My Understanding Of Your Request"
        content: "You want to proceed with planning, but Definition of Ready (DoR) is not yet met."
        max_length: 100
      
      challenge:
        display: true
        format: "## âš¡ Cannot Proceed - DoR Incomplete"
        style: "challenge_only"
        content: "I cannot move forward with analysis or implementation until DoR is satisfied with zero ambiguity."
        max_length: 120
      
      response:
        format: "## ğŸ’¬ Response"
        style: "detailed_with_line_feedback"
        content: |
          âŒ **DoR Status: INCOMPLETE**
          
          **Missing Requirements:**
          {missing_items_list}
          
          **Ambiguities Detected (Line-Level Feedback):**
          
          {ambiguity_line_feedback}
          
          **Unvalidated Dependencies:**
          {dependency_list}
        placeholders: ["missing_items_list", "ambiguity_line_feedback", "dependency_list"]
      
      request_echo:
        format: "## ğŸ“ Your Request"
        content: "Proceed with planning"
      
      next_steps:
        format: "## ğŸ” Next Steps"
        style: "remediation_checklist"
        content: |
          1. **Answer clarifying questions** - Provide specific, measurable answers
          2. **Resolve ambiguities** - Replace vague terms with exact specifications
          3. **Validate dependencies** - Confirm all referenced resources exist
          4. **Review DoR checklist** - Ensure all items checked
          5. **Resubmit for approval** - Once DoR is complete
          
          âš ï¸ I will not approve this plan until DoR is met.
    
    token_budget: 650
    estimated_tokens: 590

  planning_security_review:
    name: "Planning Security Review - OWASP Checklist"
    version: "3.0"
    category: "planning"
    trigger:
      - "planning_security_review"
      - "security review"
    
    adaptation:
      format: "detailed"
      challenge: "accept_only"
      code_display: "none"
      verbosity: "high"
    
    structure:
      header:
        format: "# ğŸ§  CORTEX Security Review (OWASP)"
        include_author: true
      
      understanding:
        format: "## ğŸ¯ My Understanding Of Your Request"
        content: "You want a security review for {feature_name} mapped to OWASP Top 10."
        placeholders: ["feature_name"]
        max_length: 90
      
      challenge:
        display: true
        format: "## âœ“ Security Validation Required"
        style: "accept_only"
        content: "Security validation is mandatory before development."
        max_length: 60
      
      response:
        format: "## ğŸ’¬ Response"
        style: "detailed_with_checklist"
        content: |
          ğŸ”’ **Auto-Detected Feature Type:** {feature_type}
          
          **Relevant OWASP Top 10 Categories:**
          
          <details>
          <summary><strong>âœ… A01 - Broken Access Control</strong></summary>
          
          {a01_checklist}
          </details>
          
          <details>
          <summary><strong>âœ… A02 - Cryptographic Failures</strong></summary>
          
          {a02_checklist}
          </details>
          
          <details>
          <summary><strong>âœ… A03 - Injection</strong></summary>
          
          {a03_checklist}
          </details>
          
          <details>
          <summary><strong>âœ… A07 - Authentication Failures</strong></summary>
          
          {a07_checklist}
          </details>
          
          <details>
          <summary><strong>âœ… A09 - Logging & Monitoring</strong></summary>
          
          {a09_checklist}
          </details>
        placeholders: ["feature_type", "a01_checklist", "a02_checklist", "a03_checklist", "a07_checklist", "a09_checklist"]
      
      request_echo:
        format: "## ğŸ“ Your Request"
        content: "Security review for {feature_name}"
        placeholders: ["feature_name"]
        max_length: 60
      
      next_steps:
        format: "## ğŸ” Next Steps"
        style: "security_validation"
        content: |
          1. **Review checklist** - Check all applicable items
          2. **Identify HIGH/CRITICAL risks** - Flag unchecked critical items
          3. **Mitigation plan** - Define how to address each risk
          4. **Automated scanning** - Run security tools (detect-secrets, Bandit)
          5. **Security approval** - Say "security approved" when complete
          
          âš ï¸ **Security Gate:** HIGH/CRITICAL vulnerabilities must be addressed before development.
    
    token_budget: 700
    estimated_tokens: 640

  enhance_existing:
    name: "Enhancement Workflow - Discover & Improve"
    version: "3.0"
    category: "workflow"
    trigger:
      - "enhance_existing"
      - "enhance"
      - "improve"
    
    adaptation:
      format: "detailed"
      challenge: "accept_only"
      code_display: "pseudocode"
      verbosity: "high"
    
    structure:
      header:
        format: "# ğŸ§  CORTEX Enhancement Analysis"
        include_author: true
      
      understanding:
        format: "## ğŸ¯ My Understanding Of Your Request"
        content: "You want to enhance/improve/extend an existing feature in your application."
        max_length: 90
      
      challenge:
        display: true
        format: "## âœ“ Discovery Required"
        style: "accept_only"
        content: "Enhancement requires understanding current implementation before planning changes."
        max_length: 90
      
      response:
        format: "## ğŸ’¬ Response"
        style: "detailed_with_phases"
        content: |
          Starting enhancement workflow for {feature_name}:
          
          **Phase Flow:**
          ```
          Discovery â†’ Context Building â†’ Enhancement Planning â†’ Implementation
          ```
          
          ### âœ… Phase 1: Discovery
          - Crawl codebase for {feature_name} patterns
          - Extract UI components, API endpoints, database schema
          - Identify dependencies and relationships
          
          ### â³ Phase 2: Context Building
          - Analyze current architecture
          - Identify enhancement opportunities
          - Review existing tests and coverage
          
          ### â³ Phase 3: Enhancement Planning
          - Define improvement scope
          - Create DoR/DoD/Acceptance Criteria
          - Generate implementation plan
          
          ### â³ Phase 4: Implementation
          - TDD approach (RED â†’ GREEN â†’ REFACTOR)
          - Integrate with existing code
          - Validate with comprehensive tests
        placeholders: ["feature_name"]
      
      request_echo:
        format: "## ğŸ“ Your Request"
        content: "Enhance existing {feature_name}"
        placeholders: ["feature_name"]
        max_length: 60
      
      next_steps:
        format: "## ğŸ” Next Steps"
        style: "phase_based"
        content: |
          <details>
          <summary><strong>â˜ Phase 1: Discovery & Analysis</strong></summary>
          
          - Crawl codebase for patterns
          - Extract components and endpoints
          - Build dependency graph
          </details>
          
          <details>
          <summary><strong>â˜ Phase 2: Context Building</strong></summary>
          
          - Analyze architecture
          - Identify opportunities
          - Review test coverage
          </details>
          
          <details>
          <summary><strong>â˜ Phase 3: Enhancement Planning</strong></summary>
          
          - Define scope
          - Create planning document
          - Approve plan
          </details>
          
          ---
          
          **Ready to begin Phase 1: Discovery?**
    
    token_budget: 700
    estimated_tokens: 620

  fallback:
    name: "Fallback - Intelligent Response"
    version: "3.0"
    category: "fallback"
    trigger:
      - "*"
    
    adaptation:
      format: "auto"  # Automatically detect best format
      challenge: "intelligent"  # Decide based on request
      code_display: "auto"
      verbosity: "adaptive"
    
    structure:
      header:
        format: "# ğŸ§  CORTEX {operation_type}"
        include_author: true
        placeholders: ["operation_type"]
      
      understanding:
        format: "## ğŸ¯ My Understanding Of Your Request"
        content: "{user_intent_summary}"
        placeholders: ["user_intent_summary"]
        max_length: 150
      
      challenge:
        display: "conditional"  # Show only if needed
        format: "## {challenge_decision}"
        style: "intelligent"
        content: "{challenge_content}"
        placeholders: ["challenge_decision", "challenge_content"]
      
      response:
        format: "## ğŸ’¬ Response"
        style: "adaptive"
        content: "{adaptive_response}"
        placeholders: ["adaptive_response"]
      
      request_echo:
        format: "## ğŸ“ Your Request"
        content: "{refined_request}"
        placeholders: ["refined_request"]
        max_length: 80
      
      next_steps:
        format: "## ğŸ” Next Steps"
        style: "context_aware"
        content: "{context_specific_steps}"
        placeholders: ["context_specific_steps"]
    
    token_budget: 800
    estimated_tokens: 600

# ============================================================================
# TEMPLATE USAGE STATISTICS (Auto-updated)
# ============================================================================

usage_stats:
  most_used:
    - "help_table"
    - "status_check"
    - "success_general"
  least_used:
    - "error_general"
  average_tokens_per_response: 466
  token_reduction_vs_v2: "42%"

# ============================================================================
# VERSION HISTORY
# ============================================================================

version_history:
  "3.0.0":
    date: "2025-11-20"
    changes:
      - "Intelligent adaptation system"
      - "Context-aware challenge sections"
      - "Adaptive response formats"
      - "Progressive disclosure patterns"
      - "42% token reduction"
    breaking_changes:
      - "Challenge section no longer forced-display"
      - "Response format adapts to context"
      - "Code display intelligence added"
